{"ast":null,"code":"/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\nvar d3 = require('d3');\n\nvar Lib = require('../../../lib');\n\nvar extendDeepAll = Lib.extendDeepAll;\n\nvar MID_SHIFT = require('../../../constants/alignment').MID_SHIFT;\n\nvar µ = module.exports = {\n  version: '0.2.2'\n};\n\nµ.Axis = function module() {\n  var config = {\n    data: [],\n    layout: {}\n  },\n      inputConfig = {},\n      liveConfig = {};\n  var svg,\n      container,\n      dispatch = d3.dispatch('hover'),\n      radialScale,\n      angularScale;\n  var exports = {};\n\n  function render(_container) {\n    container = _container || container;\n    var data = config.data;\n    var axisConfig = config.layout;\n    if (typeof container == 'string' || container.nodeName) container = d3.select(container);\n    container.datum(data).each(function (_data, _index) {\n      var dataOriginal = _data.slice();\n\n      liveConfig = {\n        data: µ.util.cloneJson(dataOriginal),\n        layout: µ.util.cloneJson(axisConfig)\n      };\n      var colorIndex = 0;\n      dataOriginal.forEach(function (d, i) {\n        if (!d.color) {\n          d.color = axisConfig.defaultColorRange[colorIndex];\n          colorIndex = (colorIndex + 1) % axisConfig.defaultColorRange.length;\n        }\n\n        if (!d.strokeColor) {\n          d.strokeColor = d.geometry === 'LinePlot' ? d.color : d3.rgb(d.color).darker().toString();\n        }\n\n        liveConfig.data[i].color = d.color;\n        liveConfig.data[i].strokeColor = d.strokeColor;\n        liveConfig.data[i].strokeDash = d.strokeDash;\n        liveConfig.data[i].strokeSize = d.strokeSize;\n      });\n      var data = dataOriginal.filter(function (d, i) {\n        var visible = d.visible;\n        return typeof visible === 'undefined' || visible === true;\n      });\n      var isStacked = false;\n      var dataWithGroupId = data.map(function (d, i) {\n        isStacked = isStacked || typeof d.groupId !== 'undefined';\n        return d;\n      });\n\n      if (isStacked) {\n        var grouped = d3.nest().key(function (d, i) {\n          return typeof d.groupId != 'undefined' ? d.groupId : 'unstacked';\n        }).entries(dataWithGroupId);\n        var dataYStack = [];\n        var stacked = grouped.map(function (d, i) {\n          if (d.key === 'unstacked') return d.values;else {\n            var prevArray = d.values[0].r.map(function (d, i) {\n              return 0;\n            });\n            d.values.forEach(function (d, i, a) {\n              d.yStack = [prevArray];\n              dataYStack.push(prevArray);\n              prevArray = µ.util.sumArrays(d.r, prevArray);\n            });\n            return d.values;\n          }\n        });\n        data = d3.merge(stacked);\n      }\n\n      data.forEach(function (d, i) {\n        d.t = Array.isArray(d.t[0]) ? d.t : [d.t];\n        d.r = Array.isArray(d.r[0]) ? d.r : [d.r];\n      });\n      var radius = Math.min(axisConfig.width - axisConfig.margin.left - axisConfig.margin.right, axisConfig.height - axisConfig.margin.top - axisConfig.margin.bottom) / 2;\n      radius = Math.max(10, radius);\n      var chartCenter = [axisConfig.margin.left + radius, axisConfig.margin.top + radius];\n      var extent;\n\n      if (isStacked) {\n        var highestStackedValue = d3.max(µ.util.sumArrays(µ.util.arrayLast(data).r[0], µ.util.arrayLast(dataYStack)));\n        extent = [0, highestStackedValue];\n      } else extent = d3.extent(µ.util.flattenArray(data.map(function (d, i) {\n        return d.r;\n      })));\n\n      if (axisConfig.radialAxis.domain != µ.DATAEXTENT) extent[0] = 0;\n      radialScale = d3.scale.linear().domain(axisConfig.radialAxis.domain != µ.DATAEXTENT && axisConfig.radialAxis.domain ? axisConfig.radialAxis.domain : extent).range([0, radius]);\n      liveConfig.layout.radialAxis.domain = radialScale.domain();\n      var angularDataMerged = µ.util.flattenArray(data.map(function (d, i) {\n        return d.t;\n      }));\n      var isOrdinal = typeof angularDataMerged[0] === 'string';\n      var ticks;\n\n      if (isOrdinal) {\n        angularDataMerged = µ.util.deduplicate(angularDataMerged);\n        ticks = angularDataMerged.slice();\n        angularDataMerged = d3.range(angularDataMerged.length);\n        data = data.map(function (d, i) {\n          var result = d;\n          d.t = [angularDataMerged];\n          if (isStacked) result.yStack = d.yStack;\n          return result;\n        });\n      }\n\n      var hasOnlyLineOrDotPlot = data.filter(function (d, i) {\n        return d.geometry === 'LinePlot' || d.geometry === 'DotPlot';\n      }).length === data.length;\n      var needsEndSpacing = axisConfig.needsEndSpacing === null ? isOrdinal || !hasOnlyLineOrDotPlot : axisConfig.needsEndSpacing;\n      var useProvidedDomain = axisConfig.angularAxis.domain && axisConfig.angularAxis.domain != µ.DATAEXTENT && !isOrdinal && axisConfig.angularAxis.domain[0] >= 0;\n      var angularDomain = useProvidedDomain ? axisConfig.angularAxis.domain : d3.extent(angularDataMerged);\n      var angularDomainStep = Math.abs(angularDataMerged[1] - angularDataMerged[0]);\n      if (hasOnlyLineOrDotPlot && !isOrdinal) angularDomainStep = 0;\n      var angularDomainWithPadding = angularDomain.slice();\n      if (needsEndSpacing && isOrdinal) angularDomainWithPadding[1] += angularDomainStep;\n      var tickCount = axisConfig.angularAxis.ticksCount || 4;\n      if (tickCount > 8) tickCount = tickCount / (tickCount / 8) + tickCount % 8;\n\n      if (axisConfig.angularAxis.ticksStep) {\n        tickCount = (angularDomainWithPadding[1] - angularDomainWithPadding[0]) / tickCount;\n      }\n\n      var angularTicksStep = axisConfig.angularAxis.ticksStep || (angularDomainWithPadding[1] - angularDomainWithPadding[0]) / (tickCount * (axisConfig.minorTicks + 1));\n      if (ticks) angularTicksStep = Math.max(Math.round(angularTicksStep), 1);\n      if (!angularDomainWithPadding[2]) angularDomainWithPadding[2] = angularTicksStep;\n      var angularAxisRange = d3.range.apply(this, angularDomainWithPadding);\n      angularAxisRange = angularAxisRange.map(function (d, i) {\n        return parseFloat(d.toPrecision(12));\n      });\n      angularScale = d3.scale.linear().domain(angularDomainWithPadding.slice(0, 2)).range(axisConfig.direction === 'clockwise' ? [0, 360] : [360, 0]);\n      liveConfig.layout.angularAxis.domain = angularScale.domain();\n      liveConfig.layout.angularAxis.endPadding = needsEndSpacing ? angularDomainStep : 0;\n      svg = d3.select(this).select('svg.chart-root');\n\n      if (typeof svg === 'undefined' || svg.empty()) {\n        var skeleton = \"<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'></circle>' + '<g class='geometry-group'></g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'></circle>' + '</g>' + '<g class='angular axis-group'></g>' + '<g class='guides-group'><line></line><circle r='0'></circle></g>' + '</g>' + '<g class='legend-group'></g>' + '<g class='tooltips-group'></g>' + '<g class='title-group'><text></text></g>' + '</g>' + '</svg>\";\n        var doc = new DOMParser().parseFromString(skeleton, 'application/xml');\n        var newSvg = this.appendChild(this.ownerDocument.importNode(doc.documentElement, true));\n        svg = d3.select(newSvg);\n      }\n\n      svg.select('.guides-group').style({\n        'pointer-events': 'none'\n      });\n      svg.select('.angular.axis-group').style({\n        'pointer-events': 'none'\n      });\n      svg.select('.radial.axis-group').style({\n        'pointer-events': 'none'\n      });\n      var chartGroup = svg.select('.chart-group');\n      var lineStyle = {\n        fill: 'none',\n        stroke: axisConfig.tickColor\n      };\n      var fontStyle = {\n        'font-size': axisConfig.font.size,\n        'font-family': axisConfig.font.family,\n        fill: axisConfig.font.color,\n        'text-shadow': ['-1px 0px', '1px -1px', '-1px 1px', '1px 1px'].map(function (d, i) {\n          return ' ' + d + ' 0 ' + axisConfig.font.outlineColor;\n        }).join(',')\n      };\n      var legendContainer;\n\n      if (axisConfig.showLegend) {\n        legendContainer = svg.select('.legend-group').attr({\n          transform: 'translate(' + [radius, axisConfig.margin.top] + ')'\n        }).style({\n          display: 'block'\n        });\n        var elements = data.map(function (d, i) {\n          var datumClone = µ.util.cloneJson(d);\n          datumClone.symbol = d.geometry === 'DotPlot' ? d.dotType || 'circle' : d.geometry != 'LinePlot' ? 'square' : 'line';\n          datumClone.visibleInLegend = typeof d.visibleInLegend === 'undefined' || d.visibleInLegend;\n          datumClone.color = d.geometry === 'LinePlot' ? d.strokeColor : d.color;\n          return datumClone;\n        });\n        µ.Legend().config({\n          data: data.map(function (d, i) {\n            return d.name || 'Element' + i;\n          }),\n          legendConfig: extendDeepAll({}, µ.Legend.defaultConfig().legendConfig, {\n            container: legendContainer,\n            elements: elements,\n            reverseOrder: axisConfig.legend.reverseOrder\n          })\n        })();\n        var legendBBox = legendContainer.node().getBBox();\n        radius = Math.min(axisConfig.width - legendBBox.width - axisConfig.margin.left - axisConfig.margin.right, axisConfig.height - axisConfig.margin.top - axisConfig.margin.bottom) / 2;\n        radius = Math.max(10, radius);\n        chartCenter = [axisConfig.margin.left + radius, axisConfig.margin.top + radius];\n        radialScale.range([0, radius]);\n        liveConfig.layout.radialAxis.domain = radialScale.domain();\n        legendContainer.attr('transform', 'translate(' + [chartCenter[0] + radius, chartCenter[1] - radius] + ')');\n      } else {\n        legendContainer = svg.select('.legend-group').style({\n          display: 'none'\n        });\n      }\n\n      svg.attr({\n        width: axisConfig.width,\n        height: axisConfig.height\n      }).style({\n        opacity: axisConfig.opacity\n      });\n      chartGroup.attr('transform', 'translate(' + chartCenter + ')').style({\n        cursor: 'crosshair'\n      });\n      var centeringOffset = [(axisConfig.width - (axisConfig.margin.left + axisConfig.margin.right + radius * 2 + (legendBBox ? legendBBox.width : 0))) / 2, (axisConfig.height - (axisConfig.margin.top + axisConfig.margin.bottom + radius * 2)) / 2];\n      centeringOffset[0] = Math.max(0, centeringOffset[0]);\n      centeringOffset[1] = Math.max(0, centeringOffset[1]);\n      svg.select('.outer-group').attr('transform', 'translate(' + centeringOffset + ')');\n\n      if (axisConfig.title && axisConfig.title.text) {\n        var title = svg.select('g.title-group text').style(fontStyle).text(axisConfig.title.text);\n        var titleBBox = title.node().getBBox();\n        title.attr({\n          x: chartCenter[0] - titleBBox.width / 2,\n          y: chartCenter[1] - radius - 20\n        });\n      }\n\n      var radialAxis = svg.select('.radial.axis-group');\n\n      if (axisConfig.radialAxis.gridLinesVisible) {\n        var gridCircles = radialAxis.selectAll('circle.grid-circle').data(radialScale.ticks(5));\n        gridCircles.enter().append('circle').attr({\n          'class': 'grid-circle'\n        }).style(lineStyle);\n        gridCircles.attr('r', radialScale);\n        gridCircles.exit().remove();\n      }\n\n      radialAxis.select('circle.outside-circle').attr({\n        r: radius\n      }).style(lineStyle);\n      var backgroundCircle = svg.select('circle.background-circle').attr({\n        r: radius\n      }).style({\n        fill: axisConfig.backgroundColor,\n        stroke: axisConfig.stroke\n      });\n\n      function currentAngle(d, i) {\n        return angularScale(d) % 360 + axisConfig.orientation;\n      }\n\n      if (axisConfig.radialAxis.visible) {\n        var axis = d3.svg.axis().scale(radialScale).ticks(5).tickSize(5);\n        radialAxis.call(axis).attr({\n          transform: 'rotate(' + axisConfig.radialAxis.orientation + ')'\n        });\n        radialAxis.selectAll('.domain').style(lineStyle);\n        radialAxis.selectAll('g>text').text(function (d, i) {\n          return this.textContent + axisConfig.radialAxis.ticksSuffix;\n        }).style(fontStyle).style({\n          'text-anchor': 'start'\n        }).attr({\n          x: 0,\n          y: 0,\n          dx: 0,\n          dy: 0,\n          transform: function (d, i) {\n            if (axisConfig.radialAxis.tickOrientation === 'horizontal') {\n              return 'rotate(' + -axisConfig.radialAxis.orientation + ') translate(' + [0, fontStyle['font-size']] + ')';\n            } else return 'translate(' + [0, fontStyle['font-size']] + ')';\n          }\n        });\n        radialAxis.selectAll('g>line').style({\n          stroke: 'black'\n        });\n      }\n\n      var angularAxis = svg.select('.angular.axis-group').selectAll('g.angular-tick').data(angularAxisRange);\n      var angularAxisEnter = angularAxis.enter().append('g').classed('angular-tick', true);\n      angularAxis.attr({\n        transform: function (d, i) {\n          return 'rotate(' + currentAngle(d, i) + ')';\n        }\n      }).style({\n        display: axisConfig.angularAxis.visible ? 'block' : 'none'\n      });\n      angularAxis.exit().remove();\n      angularAxisEnter.append('line').classed('grid-line', true).classed('major', function (d, i) {\n        return i % (axisConfig.minorTicks + 1) == 0;\n      }).classed('minor', function (d, i) {\n        return !(i % (axisConfig.minorTicks + 1) == 0);\n      }).style(lineStyle);\n      angularAxisEnter.selectAll('.minor').style({\n        stroke: axisConfig.minorTickColor\n      });\n      angularAxis.select('line.grid-line').attr({\n        x1: axisConfig.tickLength ? radius - axisConfig.tickLength : 0,\n        x2: radius\n      }).style({\n        display: axisConfig.angularAxis.gridLinesVisible ? 'block' : 'none'\n      });\n      angularAxisEnter.append('text').classed('axis-text', true).style(fontStyle);\n      var ticksText = angularAxis.select('text.axis-text').attr({\n        x: radius + axisConfig.labelOffset,\n        dy: MID_SHIFT + 'em',\n        transform: function (d, i) {\n          var angle = currentAngle(d, i);\n          var rad = radius + axisConfig.labelOffset;\n          var orient = axisConfig.angularAxis.tickOrientation;\n          if (orient == 'horizontal') return 'rotate(' + -angle + ' ' + rad + ' 0)';else if (orient == 'radial') return angle < 270 && angle > 90 ? 'rotate(180 ' + rad + ' 0)' : null;else return 'rotate(' + (angle <= 180 && angle > 0 ? -90 : 90) + ' ' + rad + ' 0)';\n        }\n      }).style({\n        'text-anchor': 'middle',\n        display: axisConfig.angularAxis.labelsVisible ? 'block' : 'none'\n      }).text(function (d, i) {\n        if (i % (axisConfig.minorTicks + 1) != 0) return '';\n\n        if (ticks) {\n          return ticks[d] + axisConfig.angularAxis.ticksSuffix;\n        } else return d + axisConfig.angularAxis.ticksSuffix;\n      }).style(fontStyle);\n      if (axisConfig.angularAxis.rewriteTicks) ticksText.text(function (d, i) {\n        if (i % (axisConfig.minorTicks + 1) != 0) return '';\n        return axisConfig.angularAxis.rewriteTicks(this.textContent, i);\n      });\n      var rightmostTickEndX = d3.max(chartGroup.selectAll('.angular-tick text')[0].map(function (d, i) {\n        return d.getCTM().e + d.getBBox().width;\n      }));\n      legendContainer.attr({\n        transform: 'translate(' + [radius + rightmostTickEndX, axisConfig.margin.top] + ')'\n      });\n      var hasGeometry = svg.select('g.geometry-group').selectAll('g').size() > 0;\n      var geometryContainer = svg.select('g.geometry-group').selectAll('g.geometry').data(data);\n      geometryContainer.enter().append('g').attr({\n        'class': function (d, i) {\n          return 'geometry geometry' + i;\n        }\n      });\n      geometryContainer.exit().remove();\n\n      if (data[0] || hasGeometry) {\n        var geometryConfigs = [];\n        data.forEach(function (d, i) {\n          var geometryConfig = {};\n          geometryConfig.radialScale = radialScale;\n          geometryConfig.angularScale = angularScale;\n          geometryConfig.container = geometryContainer.filter(function (dB, iB) {\n            return iB == i;\n          });\n          geometryConfig.geometry = d.geometry;\n          geometryConfig.orientation = axisConfig.orientation;\n          geometryConfig.direction = axisConfig.direction;\n          geometryConfig.index = i;\n          geometryConfigs.push({\n            data: d,\n            geometryConfig: geometryConfig\n          });\n        });\n        var geometryConfigsGrouped = d3.nest().key(function (d, i) {\n          return typeof d.data.groupId != 'undefined' || 'unstacked';\n        }).entries(geometryConfigs);\n        var geometryConfigsGrouped2 = [];\n        geometryConfigsGrouped.forEach(function (d, i) {\n          if (d.key === 'unstacked') geometryConfigsGrouped2 = geometryConfigsGrouped2.concat(d.values.map(function (d, i) {\n            return [d];\n          }));else geometryConfigsGrouped2.push(d.values);\n        });\n        geometryConfigsGrouped2.forEach(function (d, i) {\n          var geometry;\n          if (Array.isArray(d)) geometry = d[0].geometryConfig.geometry;else geometry = d.geometryConfig.geometry;\n          var finalGeometryConfig = d.map(function (dB, iB) {\n            return extendDeepAll(µ[geometry].defaultConfig(), dB);\n          });\n          µ[geometry]().config(finalGeometryConfig)();\n        });\n      }\n\n      var guides = svg.select('.guides-group');\n      var tooltipContainer = svg.select('.tooltips-group');\n      var angularTooltip = µ.tooltipPanel().config({\n        container: tooltipContainer,\n        fontSize: 8\n      })();\n      var radialTooltip = µ.tooltipPanel().config({\n        container: tooltipContainer,\n        fontSize: 8\n      })();\n      var geometryTooltip = µ.tooltipPanel().config({\n        container: tooltipContainer,\n        hasTick: true\n      })();\n      var angularValue, radialValue;\n\n      if (!isOrdinal) {\n        var angularGuideLine = guides.select('line').attr({\n          x1: 0,\n          y1: 0,\n          y2: 0\n        }).style({\n          stroke: 'grey',\n          'pointer-events': 'none'\n        });\n        chartGroup.on('mousemove.angular-guide', function (d, i) {\n          var mouseAngle = µ.util.getMousePos(backgroundCircle).angle;\n          angularGuideLine.attr({\n            x2: -radius,\n            transform: 'rotate(' + mouseAngle + ')'\n          }).style({\n            opacity: .5\n          });\n          var angleWithOriginOffset = (mouseAngle + 180 + 360 - axisConfig.orientation) % 360;\n          angularValue = angularScale.invert(angleWithOriginOffset);\n          var pos = µ.util.convertToCartesian(radius + 12, mouseAngle + 180);\n          angularTooltip.text(µ.util.round(angularValue)).move([pos[0] + chartCenter[0], pos[1] + chartCenter[1]]);\n        }).on('mouseout.angular-guide', function (d, i) {\n          guides.select('line').style({\n            opacity: 0\n          });\n        });\n      }\n\n      var angularGuideCircle = guides.select('circle').style({\n        stroke: 'grey',\n        fill: 'none'\n      });\n      chartGroup.on('mousemove.radial-guide', function (d, i) {\n        var r = µ.util.getMousePos(backgroundCircle).radius;\n        angularGuideCircle.attr({\n          r: r\n        }).style({\n          opacity: .5\n        });\n        radialValue = radialScale.invert(µ.util.getMousePos(backgroundCircle).radius);\n        var pos = µ.util.convertToCartesian(r, axisConfig.radialAxis.orientation);\n        radialTooltip.text(µ.util.round(radialValue)).move([pos[0] + chartCenter[0], pos[1] + chartCenter[1]]);\n      }).on('mouseout.radial-guide', function (d, i) {\n        angularGuideCircle.style({\n          opacity: 0\n        });\n        geometryTooltip.hide();\n        angularTooltip.hide();\n        radialTooltip.hide();\n      });\n      svg.selectAll('.geometry-group .mark').on('mouseover.tooltip', function (d, i) {\n        var el = d3.select(this);\n        var color = this.style.fill;\n        var newColor = 'black';\n        var opacity = this.style.opacity || 1;\n        el.attr({\n          'data-opacity': opacity\n        });\n\n        if (color && color !== 'none') {\n          el.attr({\n            'data-fill': color\n          });\n          newColor = d3.hsl(color).darker().toString();\n          el.style({\n            fill: newColor,\n            opacity: 1\n          });\n          var textData = {\n            t: µ.util.round(d[0]),\n            r: µ.util.round(d[1])\n          };\n          if (isOrdinal) textData.t = ticks[d[0]];\n          var text = 't: ' + textData.t + ', r: ' + textData.r;\n          var bbox = this.getBoundingClientRect();\n          var svgBBox = svg.node().getBoundingClientRect();\n          var pos = [bbox.left + bbox.width / 2 - centeringOffset[0] - svgBBox.left, bbox.top + bbox.height / 2 - centeringOffset[1] - svgBBox.top];\n          geometryTooltip.config({\n            color: newColor\n          }).text(text);\n          geometryTooltip.move(pos);\n        } else {\n          color = this.style.stroke || 'black';\n          el.attr({\n            'data-stroke': color\n          });\n          newColor = d3.hsl(color).darker().toString();\n          el.style({\n            stroke: newColor,\n            opacity: 1\n          });\n        }\n      }).on('mousemove.tooltip', function (d, i) {\n        if (d3.event.which != 0) return false;\n        if (d3.select(this).attr('data-fill')) geometryTooltip.show();\n      }).on('mouseout.tooltip', function (d, i) {\n        geometryTooltip.hide();\n        var el = d3.select(this);\n        var fillColor = el.attr('data-fill');\n        if (fillColor) el.style({\n          fill: fillColor,\n          opacity: el.attr('data-opacity')\n        });else el.style({\n          stroke: el.attr('data-stroke'),\n          opacity: el.attr('data-opacity')\n        });\n      });\n    });\n    return exports;\n  }\n\n  exports.render = function (_container) {\n    render(_container);\n    return this;\n  };\n\n  exports.config = function (_x) {\n    if (!arguments.length) return config;\n    var xClone = µ.util.cloneJson(_x);\n    xClone.data.forEach(function (d, i) {\n      if (!config.data[i]) config.data[i] = {};\n      extendDeepAll(config.data[i], µ.Axis.defaultConfig().data[0]);\n      extendDeepAll(config.data[i], d);\n    });\n    extendDeepAll(config.layout, µ.Axis.defaultConfig().layout);\n    extendDeepAll(config.layout, xClone.layout);\n    return this;\n  };\n\n  exports.getLiveConfig = function () {\n    return liveConfig;\n  };\n\n  exports.getinputConfig = function () {\n    return inputConfig;\n  };\n\n  exports.radialScale = function (_x) {\n    return radialScale;\n  };\n\n  exports.angularScale = function (_x) {\n    return angularScale;\n  };\n\n  exports.svg = function () {\n    return svg;\n  };\n\n  d3.rebind(exports, dispatch, 'on');\n  return exports;\n};\n\nµ.Axis.defaultConfig = function (d, i) {\n  var config = {\n    data: [{\n      t: [1, 2, 3, 4],\n      r: [10, 11, 12, 13],\n      name: 'Line1',\n      geometry: 'LinePlot',\n      color: null,\n      strokeDash: 'solid',\n      strokeColor: null,\n      strokeSize: '1',\n      visibleInLegend: true,\n      opacity: 1\n    }],\n    layout: {\n      defaultColorRange: d3.scale.category10().range(),\n      title: null,\n      height: 450,\n      width: 500,\n      margin: {\n        top: 40,\n        right: 40,\n        bottom: 40,\n        left: 40\n      },\n      font: {\n        size: 12,\n        color: 'gray',\n        outlineColor: 'white',\n        family: 'Tahoma, sans-serif'\n      },\n      direction: 'clockwise',\n      orientation: 0,\n      labelOffset: 10,\n      radialAxis: {\n        domain: null,\n        orientation: -45,\n        ticksSuffix: '',\n        visible: true,\n        gridLinesVisible: true,\n        tickOrientation: 'horizontal',\n        rewriteTicks: null\n      },\n      angularAxis: {\n        domain: [0, 360],\n        ticksSuffix: '',\n        visible: true,\n        gridLinesVisible: true,\n        labelsVisible: true,\n        tickOrientation: 'horizontal',\n        rewriteTicks: null,\n        ticksCount: null,\n        ticksStep: null\n      },\n      minorTicks: 0,\n      tickLength: null,\n      tickColor: 'silver',\n      minorTickColor: '#eee',\n      backgroundColor: 'none',\n      needsEndSpacing: null,\n      showLegend: true,\n      legend: {\n        reverseOrder: false\n      },\n      opacity: 1\n    }\n  };\n  return config;\n};\n\nµ.util = {};\nµ.DATAEXTENT = 'dataExtent';\nµ.AREA = 'AreaChart';\nµ.LINE = 'LinePlot';\nµ.DOT = 'DotPlot';\nµ.BAR = 'BarChart';\n\nµ.util._override = function (_objA, _objB) {\n  for (var x in _objA) if (x in _objB) _objB[x] = _objA[x];\n};\n\nµ.util._extend = function (_objA, _objB) {\n  for (var x in _objA) _objB[x] = _objA[x];\n};\n\nµ.util._rndSnd = function () {\n  return Math.random() * 2 - 1 + (Math.random() * 2 - 1) + (Math.random() * 2 - 1);\n};\n\nµ.util.dataFromEquation2 = function (_equation, _step) {\n  var step = _step || 6;\n  var data = d3.range(0, 360 + step, step).map(function (deg, index) {\n    var theta = deg * Math.PI / 180;\n\n    var radius = _equation(theta);\n\n    return [deg, radius];\n  });\n  return data;\n};\n\nµ.util.dataFromEquation = function (_equation, _step, _name) {\n  var step = _step || 6;\n  var t = [],\n      r = [];\n  d3.range(0, 360 + step, step).forEach(function (deg, index) {\n    var theta = deg * Math.PI / 180;\n\n    var radius = _equation(theta);\n\n    t.push(deg);\n    r.push(radius);\n  });\n  var result = {\n    t: t,\n    r: r\n  };\n  if (_name) result.name = _name;\n  return result;\n};\n\nµ.util.ensureArray = function (_val, _count) {\n  if (typeof _val === 'undefined') return null;\n  var arr = [].concat(_val);\n  return d3.range(_count).map(function (d, i) {\n    return arr[i] || arr[0];\n  });\n};\n\nµ.util.fillArrays = function (_obj, _valueNames, _count) {\n  _valueNames.forEach(function (d, i) {\n    _obj[d] = µ.util.ensureArray(_obj[d], _count);\n  });\n\n  return _obj;\n};\n\nµ.util.cloneJson = function (json) {\n  return JSON.parse(JSON.stringify(json));\n};\n\nµ.util.validateKeys = function (obj, keys) {\n  if (typeof keys === 'string') keys = keys.split('.');\n  var next = keys.shift();\n  return obj[next] && (!keys.length || objHasKeys(obj[next], keys));\n};\n\nµ.util.sumArrays = function (a, b) {\n  return d3.zip(a, b).map(function (d, i) {\n    return d3.sum(d);\n  });\n};\n\nµ.util.arrayLast = function (a) {\n  return a[a.length - 1];\n};\n\nµ.util.arrayEqual = function (a, b) {\n  var i = Math.max(a.length, b.length, 1);\n\n  while (i-- >= 0 && a[i] === b[i]);\n\n  return i === -2;\n};\n\nµ.util.flattenArray = function (arr) {\n  var r = [];\n\n  while (!µ.util.arrayEqual(r, arr)) {\n    r = arr;\n    arr = [].concat.apply([], arr);\n  }\n\n  return arr;\n};\n\nµ.util.deduplicate = function (arr) {\n  return arr.filter(function (v, i, a) {\n    return a.indexOf(v) == i;\n  });\n};\n\nµ.util.convertToCartesian = function (radius, theta) {\n  var thetaRadians = theta * Math.PI / 180;\n  var x = radius * Math.cos(thetaRadians);\n  var y = radius * Math.sin(thetaRadians);\n  return [x, y];\n};\n\nµ.util.round = function (_value, _digits) {\n  var digits = _digits || 2;\n  var mult = Math.pow(10, digits);\n  return Math.round(_value * mult) / mult;\n};\n\nµ.util.getMousePos = function (_referenceElement) {\n  var mousePos = d3.mouse(_referenceElement.node());\n  var mouseX = mousePos[0];\n  var mouseY = mousePos[1];\n  var mouse = {};\n  mouse.x = mouseX;\n  mouse.y = mouseY;\n  mouse.pos = mousePos;\n  mouse.angle = (Math.atan2(mouseY, mouseX) + Math.PI) * 180 / Math.PI;\n  mouse.radius = Math.sqrt(mouseX * mouseX + mouseY * mouseY);\n  return mouse;\n};\n\nµ.util.duplicatesCount = function (arr) {\n  var uniques = {},\n      val;\n  var dups = {};\n\n  for (var i = 0, len = arr.length; i < len; i++) {\n    val = arr[i];\n\n    if (val in uniques) {\n      uniques[val]++;\n      dups[val] = uniques[val];\n    } else {\n      uniques[val] = 1;\n    }\n  }\n\n  return dups;\n};\n\nµ.util.duplicates = function (arr) {\n  return Object.keys(µ.util.duplicatesCount(arr));\n};\n\nµ.util.translator = function (obj, sourceBranch, targetBranch, reverse) {\n  if (reverse) {\n    var targetBranchCopy = targetBranch.slice();\n    targetBranch = sourceBranch;\n    sourceBranch = targetBranchCopy;\n  }\n\n  var value = sourceBranch.reduce(function (previousValue, currentValue) {\n    if (typeof previousValue != 'undefined') return previousValue[currentValue];\n  }, obj);\n  if (typeof value === 'undefined') return;\n  sourceBranch.reduce(function (previousValue, currentValue, index) {\n    if (typeof previousValue == 'undefined') return;\n    if (index === sourceBranch.length - 1) delete previousValue[currentValue];\n    return previousValue[currentValue];\n  }, obj);\n  targetBranch.reduce(function (previousValue, currentValue, index) {\n    if (typeof previousValue[currentValue] === 'undefined') previousValue[currentValue] = {};\n    if (index === targetBranch.length - 1) previousValue[currentValue] = value;\n    return previousValue[currentValue];\n  }, obj);\n};\n\nµ.PolyChart = function module() {\n  var config = [µ.PolyChart.defaultConfig()];\n  var dispatch = d3.dispatch('hover');\n  var dashArray = {\n    solid: 'none',\n    dash: [5, 2],\n    dot: [2, 5]\n  };\n  var colorScale;\n\n  function exports() {\n    var geometryConfig = config[0].geometryConfig;\n    var container = geometryConfig.container;\n    if (typeof container == 'string') container = d3.select(container);\n    container.datum(config).each(function (_config, _index) {\n      var isStack = !!_config[0].data.yStack;\n\n      var data = _config.map(function (d, i) {\n        if (isStack) return d3.zip(d.data.t[0], d.data.r[0], d.data.yStack[0]);else return d3.zip(d.data.t[0], d.data.r[0]);\n      });\n\n      var angularScale = geometryConfig.angularScale;\n      var domainMin = geometryConfig.radialScale.domain()[0];\n      var generator = {};\n\n      generator.bar = function (d, i, pI) {\n        var dataConfig = _config[pI].data;\n        var h = geometryConfig.radialScale(d[1]) - geometryConfig.radialScale(0);\n        var stackTop = geometryConfig.radialScale(d[2] || 0);\n        var w = dataConfig.barWidth;\n        d3.select(this).attr({\n          'class': 'mark bar',\n          d: 'M' + [[h + stackTop, -w / 2], [h + stackTop, w / 2], [stackTop, w / 2], [stackTop, -w / 2]].join('L') + 'Z',\n          transform: function (d, i) {\n            return 'rotate(' + (geometryConfig.orientation + angularScale(d[0])) + ')';\n          }\n        });\n      };\n\n      generator.dot = function (d, i, pI) {\n        var stackedData = d[2] ? [d[0], d[1] + d[2]] : d;\n        var symbol = d3.svg.symbol().size(_config[pI].data.dotSize).type(_config[pI].data.dotType)(d, i);\n        d3.select(this).attr({\n          'class': 'mark dot',\n          d: symbol,\n          transform: function (d, i) {\n            var coord = convertToCartesian(getPolarCoordinates(stackedData));\n            return 'translate(' + [coord.x, coord.y] + ')';\n          }\n        });\n      };\n\n      var line = d3.svg.line.radial().interpolate(_config[0].data.lineInterpolation).radius(function (d) {\n        return geometryConfig.radialScale(d[1]);\n      }).angle(function (d) {\n        return geometryConfig.angularScale(d[0]) * Math.PI / 180;\n      });\n\n      generator.line = function (d, i, pI) {\n        var lineData = d[2] ? data[pI].map(function (d, i) {\n          return [d[0], d[1] + d[2]];\n        }) : data[pI];\n        d3.select(this).each(generator['dot']).style({\n          opacity: function (dB, iB) {\n            return +_config[pI].data.dotVisible;\n          },\n          fill: markStyle.stroke(d, i, pI)\n        }).attr({\n          'class': 'mark dot'\n        });\n        if (i > 0) return;\n        var lineSelection = d3.select(this.parentNode).selectAll('path.line').data([0]);\n        lineSelection.enter().insert('path');\n        lineSelection.attr({\n          'class': 'line',\n          d: line(lineData),\n          transform: function (dB, iB) {\n            return 'rotate(' + (geometryConfig.orientation + 90) + ')';\n          },\n          'pointer-events': 'none'\n        }).style({\n          fill: function (dB, iB) {\n            return markStyle.fill(d, i, pI);\n          },\n          'fill-opacity': 0,\n          stroke: function (dB, iB) {\n            return markStyle.stroke(d, i, pI);\n          },\n          'stroke-width': function (dB, iB) {\n            return markStyle['stroke-width'](d, i, pI);\n          },\n          'stroke-dasharray': function (dB, iB) {\n            return markStyle['stroke-dasharray'](d, i, pI);\n          },\n          opacity: function (dB, iB) {\n            return markStyle.opacity(d, i, pI);\n          },\n          display: function (dB, iB) {\n            return markStyle.display(d, i, pI);\n          }\n        });\n      };\n\n      var angularRange = geometryConfig.angularScale.range();\n      var triangleAngle = Math.abs(angularRange[1] - angularRange[0]) / data[0].length * Math.PI / 180;\n      var arc = d3.svg.arc().startAngle(function (d) {\n        return -triangleAngle / 2;\n      }).endAngle(function (d) {\n        return triangleAngle / 2;\n      }).innerRadius(function (d) {\n        return geometryConfig.radialScale(domainMin + (d[2] || 0));\n      }).outerRadius(function (d) {\n        return geometryConfig.radialScale(domainMin + (d[2] || 0)) + geometryConfig.radialScale(d[1]);\n      });\n\n      generator.arc = function (d, i, pI) {\n        d3.select(this).attr({\n          'class': 'mark arc',\n          d: arc,\n          transform: function (d, i) {\n            return 'rotate(' + (geometryConfig.orientation + angularScale(d[0]) + 90) + ')';\n          }\n        });\n      };\n\n      var markStyle = {\n        fill: function (d, i, pI) {\n          return _config[pI].data.color;\n        },\n        stroke: function (d, i, pI) {\n          return _config[pI].data.strokeColor;\n        },\n        'stroke-width': function (d, i, pI) {\n          return _config[pI].data.strokeSize + 'px';\n        },\n        'stroke-dasharray': function (d, i, pI) {\n          return dashArray[_config[pI].data.strokeDash];\n        },\n        opacity: function (d, i, pI) {\n          return _config[pI].data.opacity;\n        },\n        display: function (d, i, pI) {\n          return typeof _config[pI].data.visible === 'undefined' || _config[pI].data.visible ? 'block' : 'none';\n        }\n      };\n      var geometryLayer = d3.select(this).selectAll('g.layer').data(data);\n      geometryLayer.enter().append('g').attr({\n        'class': 'layer'\n      });\n      var geometry = geometryLayer.selectAll('path.mark').data(function (d, i) {\n        return d;\n      });\n      geometry.enter().append('path').attr({\n        'class': 'mark'\n      });\n      geometry.style(markStyle).each(generator[geometryConfig.geometryType]);\n      geometry.exit().remove();\n      geometryLayer.exit().remove();\n\n      function getPolarCoordinates(d, i) {\n        var r = geometryConfig.radialScale(d[1]);\n        var t = (geometryConfig.angularScale(d[0]) + geometryConfig.orientation) * Math.PI / 180;\n        return {\n          r: r,\n          t: t\n        };\n      }\n\n      function convertToCartesian(polarCoordinates) {\n        var x = polarCoordinates.r * Math.cos(polarCoordinates.t);\n        var y = polarCoordinates.r * Math.sin(polarCoordinates.t);\n        return {\n          x: x,\n          y: y\n        };\n      }\n    });\n  }\n\n  exports.config = function (_x) {\n    if (!arguments.length) return config;\n\n    _x.forEach(function (d, i) {\n      if (!config[i]) config[i] = {};\n      extendDeepAll(config[i], µ.PolyChart.defaultConfig());\n      extendDeepAll(config[i], d);\n    });\n\n    return this;\n  };\n\n  exports.getColorScale = function () {\n    return colorScale;\n  };\n\n  d3.rebind(exports, dispatch, 'on');\n  return exports;\n};\n\nµ.PolyChart.defaultConfig = function () {\n  var config = {\n    data: {\n      name: 'geom1',\n      t: [[1, 2, 3, 4]],\n      r: [[1, 2, 3, 4]],\n      dotType: 'circle',\n      dotSize: 64,\n      dotVisible: false,\n      barWidth: 20,\n      color: '#ffa500',\n      strokeSize: 1,\n      strokeColor: 'silver',\n      strokeDash: 'solid',\n      opacity: 1,\n      index: 0,\n      visible: true,\n      visibleInLegend: true\n    },\n    geometryConfig: {\n      geometry: 'LinePlot',\n      geometryType: 'arc',\n      direction: 'clockwise',\n      orientation: 0,\n      container: 'body',\n      radialScale: null,\n      angularScale: null,\n      colorScale: d3.scale.category20()\n    }\n  };\n  return config;\n};\n\nµ.BarChart = function module() {\n  return µ.PolyChart();\n};\n\nµ.BarChart.defaultConfig = function () {\n  var config = {\n    geometryConfig: {\n      geometryType: 'bar'\n    }\n  };\n  return config;\n};\n\nµ.AreaChart = function module() {\n  return µ.PolyChart();\n};\n\nµ.AreaChart.defaultConfig = function () {\n  var config = {\n    geometryConfig: {\n      geometryType: 'arc'\n    }\n  };\n  return config;\n};\n\nµ.DotPlot = function module() {\n  return µ.PolyChart();\n};\n\nµ.DotPlot.defaultConfig = function () {\n  var config = {\n    geometryConfig: {\n      geometryType: 'dot',\n      dotType: 'circle'\n    }\n  };\n  return config;\n};\n\nµ.LinePlot = function module() {\n  return µ.PolyChart();\n};\n\nµ.LinePlot.defaultConfig = function () {\n  var config = {\n    geometryConfig: {\n      geometryType: 'line'\n    }\n  };\n  return config;\n};\n\nµ.Legend = function module() {\n  var config = µ.Legend.defaultConfig();\n  var dispatch = d3.dispatch('hover');\n\n  function exports() {\n    var legendConfig = config.legendConfig;\n    var flattenData = config.data.map(function (d, i) {\n      return [].concat(d).map(function (dB, iB) {\n        var element = extendDeepAll({}, legendConfig.elements[i]);\n        element.name = dB;\n        element.color = [].concat(legendConfig.elements[i].color)[iB];\n        return element;\n      });\n    });\n    var data = d3.merge(flattenData);\n    data = data.filter(function (d, i) {\n      return legendConfig.elements[i] && (legendConfig.elements[i].visibleInLegend || typeof legendConfig.elements[i].visibleInLegend === 'undefined');\n    });\n    if (legendConfig.reverseOrder) data = data.reverse();\n    var container = legendConfig.container;\n    if (typeof container == 'string' || container.nodeName) container = d3.select(container);\n    var colors = data.map(function (d, i) {\n      return d.color;\n    });\n    var lineHeight = legendConfig.fontSize;\n    var isContinuous = legendConfig.isContinuous == null ? typeof data[0] === 'number' : legendConfig.isContinuous;\n    var height = isContinuous ? legendConfig.height : lineHeight * data.length;\n    var legendContainerGroup = container.classed('legend-group', true);\n    var svg = legendContainerGroup.selectAll('svg').data([0]);\n    var svgEnter = svg.enter().append('svg').attr({\n      width: 300,\n      height: height + lineHeight,\n      xmlns: 'http://www.w3.org/2000/svg',\n      'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n      version: '1.1'\n    });\n    svgEnter.append('g').classed('legend-axis', true);\n    svgEnter.append('g').classed('legend-marks', true);\n    var dataNumbered = d3.range(data.length);\n    var colorScale = d3.scale[isContinuous ? 'linear' : 'ordinal']().domain(dataNumbered).range(colors);\n    var dataScale = d3.scale[isContinuous ? 'linear' : 'ordinal']().domain(dataNumbered)[isContinuous ? 'range' : 'rangePoints']([0, height]);\n\n    var shapeGenerator = function (_type, _size) {\n      var squareSize = _size * 3;\n\n      if (_type === 'line') {\n        return 'M' + [[-_size / 2, -_size / 12], [_size / 2, -_size / 12], [_size / 2, _size / 12], [-_size / 2, _size / 12]] + 'Z';\n      } else if (d3.svg.symbolTypes.indexOf(_type) != -1) return d3.svg.symbol().type(_type).size(squareSize)();else return d3.svg.symbol().type('square').size(squareSize)();\n    };\n\n    if (isContinuous) {\n      var gradient = svg.select('.legend-marks').append('defs').append('linearGradient').attr({\n        id: 'grad1',\n        x1: '0%',\n        y1: '0%',\n        x2: '0%',\n        y2: '100%'\n      }).selectAll('stop').data(colors);\n      gradient.enter().append('stop');\n      gradient.attr({\n        offset: function (d, i) {\n          return i / (colors.length - 1) * 100 + '%';\n        }\n      }).style({\n        'stop-color': function (d, i) {\n          return d;\n        }\n      });\n      svg.append('rect').classed('legend-mark', true).attr({\n        height: legendConfig.height,\n        width: legendConfig.colorBandWidth,\n        fill: 'url(#grad1)'\n      });\n    } else {\n      var legendElement = svg.select('.legend-marks').selectAll('path.legend-mark').data(data);\n      legendElement.enter().append('path').classed('legend-mark', true);\n      legendElement.attr({\n        transform: function (d, i) {\n          return 'translate(' + [lineHeight / 2, dataScale(i) + lineHeight / 2] + ')';\n        },\n        d: function (d, i) {\n          var symbolType = d.symbol;\n          return shapeGenerator(symbolType, lineHeight);\n        },\n        fill: function (d, i) {\n          return colorScale(i);\n        }\n      });\n      legendElement.exit().remove();\n    }\n\n    var legendAxis = d3.svg.axis().scale(dataScale).orient('right');\n    var axis = svg.select('g.legend-axis').attr({\n      transform: 'translate(' + [isContinuous ? legendConfig.colorBandWidth : lineHeight, lineHeight / 2] + ')'\n    }).call(legendAxis);\n    axis.selectAll('.domain').style({\n      fill: 'none',\n      stroke: 'none'\n    });\n    axis.selectAll('line').style({\n      fill: 'none',\n      stroke: isContinuous ? legendConfig.textColor : 'none'\n    });\n    axis.selectAll('text').style({\n      fill: legendConfig.textColor,\n      'font-size': legendConfig.fontSize\n    }).text(function (d, i) {\n      return data[i].name;\n    });\n    return exports;\n  }\n\n  exports.config = function (_x) {\n    if (!arguments.length) return config;\n    extendDeepAll(config, _x);\n    return this;\n  };\n\n  d3.rebind(exports, dispatch, 'on');\n  return exports;\n};\n\nµ.Legend.defaultConfig = function (d, i) {\n  var config = {\n    data: ['a', 'b', 'c'],\n    legendConfig: {\n      elements: [{\n        symbol: 'line',\n        color: 'red'\n      }, {\n        symbol: 'square',\n        color: 'yellow'\n      }, {\n        symbol: 'diamond',\n        color: 'limegreen'\n      }],\n      height: 150,\n      colorBandWidth: 30,\n      fontSize: 12,\n      container: 'body',\n      isContinuous: null,\n      textColor: 'grey',\n      reverseOrder: false\n    }\n  };\n  return config;\n};\n\nµ.tooltipPanel = function () {\n  var tooltipEl, tooltipTextEl, backgroundEl;\n  var config = {\n    container: null,\n    hasTick: false,\n    fontSize: 12,\n    color: 'white',\n    padding: 5\n  };\n  var id = 'tooltip-' + µ.tooltipPanel.uid++;\n  var tickSize = 10;\n\n  var exports = function () {\n    tooltipEl = config.container.selectAll('g.' + id).data([0]);\n    var tooltipEnter = tooltipEl.enter().append('g').classed(id, true).style({\n      'pointer-events': 'none',\n      display: 'none'\n    });\n    backgroundEl = tooltipEnter.append('path').style({\n      fill: 'white',\n      'fill-opacity': .9\n    }).attr({\n      d: 'M0 0'\n    });\n    tooltipTextEl = tooltipEnter.append('text').attr({\n      dx: config.padding + tickSize,\n      dy: +config.fontSize * .3\n    });\n    return exports;\n  };\n\n  exports.text = function (_text) {\n    var l = d3.hsl(config.color).l;\n    var strokeColor = l >= .5 ? '#aaa' : 'white';\n    var fillColor = l >= .5 ? 'black' : 'white';\n    var text = _text || '';\n    tooltipTextEl.style({\n      fill: fillColor,\n      'font-size': config.fontSize + 'px'\n    }).text(text);\n    var padding = config.padding;\n    var bbox = tooltipTextEl.node().getBBox();\n    var boxStyle = {\n      fill: config.color,\n      stroke: strokeColor,\n      'stroke-width': '2px'\n    };\n    var backGroundW = bbox.width + padding * 2 + tickSize;\n    var backGroundH = bbox.height + padding * 2;\n    backgroundEl.attr({\n      d: 'M' + [[tickSize, -backGroundH / 2], [tickSize, -backGroundH / 4], [config.hasTick ? 0 : tickSize, 0], [tickSize, backGroundH / 4], [tickSize, backGroundH / 2], [backGroundW, backGroundH / 2], [backGroundW, -backGroundH / 2]].join('L') + 'Z'\n    }).style(boxStyle);\n    tooltipEl.attr({\n      transform: 'translate(' + [tickSize, -backGroundH / 2 + padding * 2] + ')'\n    });\n    tooltipEl.style({\n      display: 'block'\n    });\n    return exports;\n  };\n\n  exports.move = function (_pos) {\n    if (!tooltipEl) return;\n    tooltipEl.attr({\n      transform: 'translate(' + [_pos[0], _pos[1]] + ')'\n    }).style({\n      display: 'block'\n    });\n    return exports;\n  };\n\n  exports.hide = function () {\n    if (!tooltipEl) return;\n    tooltipEl.style({\n      display: 'none'\n    });\n    return exports;\n  };\n\n  exports.show = function () {\n    if (!tooltipEl) return;\n    tooltipEl.style({\n      display: 'block'\n    });\n    return exports;\n  };\n\n  exports.config = function (_x) {\n    extendDeepAll(config, _x);\n    return exports;\n  };\n\n  return exports;\n};\n\nµ.tooltipPanel.uid = 1;\nµ.adapter = {};\n\nµ.adapter.plotly = function module() {\n  var exports = {};\n\n  exports.convert = function (_inputConfig, reverse) {\n    var outputConfig = {};\n\n    if (_inputConfig.data) {\n      outputConfig.data = _inputConfig.data.map(function (d, i) {\n        var r = extendDeepAll({}, d);\n        var toTranslate = [[r, ['marker', 'color'], ['color']], [r, ['marker', 'opacity'], ['opacity']], [r, ['marker', 'line', 'color'], ['strokeColor']], [r, ['marker', 'line', 'dash'], ['strokeDash']], [r, ['marker', 'line', 'width'], ['strokeSize']], [r, ['marker', 'symbol'], ['dotType']], [r, ['marker', 'size'], ['dotSize']], [r, ['marker', 'barWidth'], ['barWidth']], [r, ['line', 'interpolation'], ['lineInterpolation']], [r, ['showlegend'], ['visibleInLegend']]];\n        toTranslate.forEach(function (d, i) {\n          µ.util.translator.apply(null, d.concat(reverse));\n        });\n        if (!reverse) delete r.marker;\n        if (reverse) delete r.groupId;\n\n        if (!reverse) {\n          if (r.type === 'scatter') {\n            if (r.mode === 'lines') r.geometry = 'LinePlot';else if (r.mode === 'markers') r.geometry = 'DotPlot';else if (r.mode === 'lines+markers') {\n              r.geometry = 'LinePlot';\n              r.dotVisible = true;\n            }\n          } else if (r.type === 'area') r.geometry = 'AreaChart';else if (r.type === 'bar') r.geometry = 'BarChart';\n\n          delete r.mode;\n          delete r.type;\n        } else {\n          if (r.geometry === 'LinePlot') {\n            r.type = 'scatter';\n\n            if (r.dotVisible === true) {\n              delete r.dotVisible;\n              r.mode = 'lines+markers';\n            } else r.mode = 'lines';\n          } else if (r.geometry === 'DotPlot') {\n            r.type = 'scatter';\n            r.mode = 'markers';\n          } else if (r.geometry === 'AreaChart') r.type = 'area';else if (r.geometry === 'BarChart') r.type = 'bar';\n\n          delete r.geometry;\n        }\n\n        return r;\n      });\n\n      if (!reverse && _inputConfig.layout && _inputConfig.layout.barmode === 'stack') {\n        var duplicates = µ.util.duplicates(outputConfig.data.map(function (d, i) {\n          return d.geometry;\n        }));\n        outputConfig.data.forEach(function (d, i) {\n          var idx = duplicates.indexOf(d.geometry);\n          if (idx != -1) outputConfig.data[i].groupId = idx;\n        });\n      }\n    }\n\n    if (_inputConfig.layout) {\n      var r = extendDeepAll({}, _inputConfig.layout);\n      var toTranslate = [[r, ['plot_bgcolor'], ['backgroundColor']], [r, ['showlegend'], ['showLegend']], [r, ['radialaxis'], ['radialAxis']], [r, ['angularaxis'], ['angularAxis']], [r.angularaxis, ['showline'], ['gridLinesVisible']], [r.angularaxis, ['showticklabels'], ['labelsVisible']], [r.angularaxis, ['nticks'], ['ticksCount']], [r.angularaxis, ['tickorientation'], ['tickOrientation']], [r.angularaxis, ['ticksuffix'], ['ticksSuffix']], [r.angularaxis, ['range'], ['domain']], [r.angularaxis, ['endpadding'], ['endPadding']], [r.radialaxis, ['showline'], ['gridLinesVisible']], [r.radialaxis, ['tickorientation'], ['tickOrientation']], [r.radialaxis, ['ticksuffix'], ['ticksSuffix']], [r.radialaxis, ['range'], ['domain']], [r.angularAxis, ['showline'], ['gridLinesVisible']], [r.angularAxis, ['showticklabels'], ['labelsVisible']], [r.angularAxis, ['nticks'], ['ticksCount']], [r.angularAxis, ['tickorientation'], ['tickOrientation']], [r.angularAxis, ['ticksuffix'], ['ticksSuffix']], [r.angularAxis, ['range'], ['domain']], [r.angularAxis, ['endpadding'], ['endPadding']], [r.radialAxis, ['showline'], ['gridLinesVisible']], [r.radialAxis, ['tickorientation'], ['tickOrientation']], [r.radialAxis, ['ticksuffix'], ['ticksSuffix']], [r.radialAxis, ['range'], ['domain']], [r.font, ['outlinecolor'], ['outlineColor']], [r.legend, ['traceorder'], ['reverseOrder']], [r, ['labeloffset'], ['labelOffset']], [r, ['defaultcolorrange'], ['defaultColorRange']]];\n      toTranslate.forEach(function (d, i) {\n        µ.util.translator.apply(null, d.concat(reverse));\n      });\n\n      if (!reverse) {\n        if (r.angularAxis && typeof r.angularAxis.ticklen !== 'undefined') r.tickLength = r.angularAxis.ticklen;\n        if (r.angularAxis && typeof r.angularAxis.tickcolor !== 'undefined') r.tickColor = r.angularAxis.tickcolor;\n      } else {\n        if (typeof r.tickLength !== 'undefined') {\n          r.angularaxis.ticklen = r.tickLength;\n          delete r.tickLength;\n        }\n\n        if (r.tickColor) {\n          r.angularaxis.tickcolor = r.tickColor;\n          delete r.tickColor;\n        }\n      }\n\n      if (r.legend && typeof r.legend.reverseOrder != 'boolean') {\n        r.legend.reverseOrder = r.legend.reverseOrder != 'normal';\n      }\n\n      if (r.legend && typeof r.legend.traceorder == 'boolean') {\n        r.legend.traceorder = r.legend.traceorder ? 'reversed' : 'normal';\n        delete r.legend.reverseOrder;\n      }\n\n      if (r.margin && typeof r.margin.t != 'undefined') {\n        var source = ['t', 'r', 'b', 'l', 'pad'];\n        var target = ['top', 'right', 'bottom', 'left', 'pad'];\n        var margin = {};\n        d3.entries(r.margin).forEach(function (dB, iB) {\n          margin[target[source.indexOf(dB.key)]] = dB.value;\n        });\n        r.margin = margin;\n      }\n\n      if (reverse) {\n        delete r.needsEndSpacing;\n        delete r.minorTickColor;\n        delete r.minorTicks;\n        delete r.angularaxis.ticksCount;\n        delete r.angularaxis.ticksCount;\n        delete r.angularaxis.ticksStep;\n        delete r.angularaxis.rewriteTicks;\n        delete r.angularaxis.nticks;\n        delete r.radialaxis.ticksCount;\n        delete r.radialaxis.ticksCount;\n        delete r.radialaxis.ticksStep;\n        delete r.radialaxis.rewriteTicks;\n        delete r.radialaxis.nticks;\n      }\n\n      outputConfig.layout = r;\n    }\n\n    return outputConfig;\n  };\n\n  return exports;\n};","map":{"version":3,"sources":["/Users/caseyrudick/Documents/landsharkrefactored-copy/client/node_modules/plotly.js/src/plots/polar/legacy/micropolar.js"],"names":["d3","require","Lib","extendDeepAll","MID_SHIFT","µ","module","exports","version","Axis","config","data","layout","inputConfig","liveConfig","svg","container","dispatch","radialScale","angularScale","render","_container","axisConfig","nodeName","select","datum","each","_data","_index","dataOriginal","slice","util","cloneJson","colorIndex","forEach","d","i","color","defaultColorRange","length","strokeColor","geometry","rgb","darker","toString","strokeDash","strokeSize","filter","visible","isStacked","dataWithGroupId","map","groupId","grouped","nest","key","entries","dataYStack","stacked","values","prevArray","r","a","yStack","push","sumArrays","merge","t","Array","isArray","radius","Math","min","width","margin","left","right","height","top","bottom","max","chartCenter","extent","highestStackedValue","arrayLast","flattenArray","radialAxis","domain","DATAEXTENT","scale","linear","range","angularDataMerged","isOrdinal","ticks","deduplicate","result","hasOnlyLineOrDotPlot","needsEndSpacing","useProvidedDomain","angularAxis","angularDomain","angularDomainStep","abs","angularDomainWithPadding","tickCount","ticksCount","ticksStep","angularTicksStep","minorTicks","round","angularAxisRange","apply","parseFloat","toPrecision","direction","endPadding","empty","skeleton","doc","DOMParser","parseFromString","newSvg","appendChild","ownerDocument","importNode","documentElement","style","chartGroup","lineStyle","fill","stroke","tickColor","fontStyle","font","size","family","outlineColor","join","legendContainer","showLegend","attr","transform","display","elements","datumClone","symbol","dotType","visibleInLegend","Legend","name","legendConfig","defaultConfig","reverseOrder","legend","legendBBox","node","getBBox","opacity","cursor","centeringOffset","title","text","titleBBox","x","y","gridLinesVisible","gridCircles","selectAll","enter","append","exit","remove","backgroundCircle","backgroundColor","currentAngle","orientation","axis","tickSize","call","textContent","ticksSuffix","dx","dy","tickOrientation","angularAxisEnter","classed","minorTickColor","x1","tickLength","x2","ticksText","labelOffset","angle","rad","orient","labelsVisible","rewriteTicks","rightmostTickEndX","getCTM","e","hasGeometry","geometryContainer","geometryConfigs","geometryConfig","dB","iB","index","geometryConfigsGrouped","geometryConfigsGrouped2","concat","finalGeometryConfig","guides","tooltipContainer","angularTooltip","tooltipPanel","fontSize","radialTooltip","geometryTooltip","hasTick","angularValue","radialValue","angularGuideLine","y1","y2","on","mouseAngle","getMousePos","angleWithOriginOffset","invert","pos","convertToCartesian","move","angularGuideCircle","hide","el","newColor","hsl","textData","bbox","getBoundingClientRect","svgBBox","event","which","show","fillColor","_x","arguments","xClone","getLiveConfig","getinputConfig","rebind","category10","AREA","LINE","DOT","BAR","_override","_objA","_objB","_extend","_rndSnd","random","dataFromEquation2","_equation","_step","step","deg","theta","PI","dataFromEquation","_name","ensureArray","_val","_count","arr","fillArrays","_obj","_valueNames","json","JSON","parse","stringify","validateKeys","obj","keys","split","next","shift","objHasKeys","b","zip","sum","arrayEqual","v","indexOf","thetaRadians","cos","sin","_value","_digits","digits","mult","pow","_referenceElement","mousePos","mouse","mouseX","mouseY","atan2","sqrt","duplicatesCount","uniques","val","dups","len","duplicates","Object","translator","sourceBranch","targetBranch","reverse","targetBranchCopy","value","reduce","previousValue","currentValue","PolyChart","dashArray","solid","dash","dot","colorScale","_config","isStack","domainMin","generator","bar","pI","dataConfig","h","stackTop","w","barWidth","stackedData","dotSize","type","coord","getPolarCoordinates","line","radial","interpolate","lineInterpolation","lineData","dotVisible","markStyle","lineSelection","parentNode","insert","angularRange","triangleAngle","arc","startAngle","endAngle","innerRadius","outerRadius","geometryLayer","geometryType","polarCoordinates","getColorScale","category20","BarChart","AreaChart","DotPlot","LinePlot","flattenData","element","colors","lineHeight","isContinuous","legendContainerGroup","svgEnter","xmlns","dataNumbered","dataScale","shapeGenerator","_type","_size","squareSize","symbolTypes","gradient","id","offset","colorBandWidth","legendElement","symbolType","legendAxis","textColor","tooltipEl","tooltipTextEl","backgroundEl","padding","uid","tooltipEnter","_text","l","boxStyle","backGroundW","backGroundH","_pos","adapter","plotly","convert","_inputConfig","outputConfig","toTranslate","marker","mode","barmode","idx","angularaxis","radialaxis","ticklen","tickcolor","traceorder","source","target","nticks"],"mappings":"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","sourcesContent":["/**\n* Copyright 2012-2020, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n\nvar d3 = require('d3');\nvar Lib = require('../../../lib');\nvar extendDeepAll = Lib.extendDeepAll;\nvar MID_SHIFT = require('../../../constants/alignment').MID_SHIFT;\n\nvar µ = module.exports = { version: '0.2.2' };\n\nµ.Axis = function module() {\n    var config = {\n        data: [],\n        layout: {}\n    }, inputConfig = {}, liveConfig = {};\n    var svg, container, dispatch = d3.dispatch('hover'), radialScale, angularScale;\n    var exports = {};\n    function render(_container) {\n        container = _container || container;\n        var data = config.data;\n        var axisConfig = config.layout;\n        if (typeof container == 'string' || container.nodeName) container = d3.select(container);\n        container.datum(data).each(function(_data, _index) {\n            var dataOriginal = _data.slice();\n            liveConfig = {\n                data: µ.util.cloneJson(dataOriginal),\n                layout: µ.util.cloneJson(axisConfig)\n            };\n            var colorIndex = 0;\n            dataOriginal.forEach(function(d, i) {\n                if (!d.color) {\n                    d.color = axisConfig.defaultColorRange[colorIndex];\n                    colorIndex = (colorIndex + 1) % axisConfig.defaultColorRange.length;\n                }\n                if (!d.strokeColor) {\n                    d.strokeColor = d.geometry === 'LinePlot' ? d.color : d3.rgb(d.color).darker().toString();\n                }\n                liveConfig.data[i].color = d.color;\n                liveConfig.data[i].strokeColor = d.strokeColor;\n                liveConfig.data[i].strokeDash = d.strokeDash;\n                liveConfig.data[i].strokeSize = d.strokeSize;\n            });\n            var data = dataOriginal.filter(function(d, i) {\n                var visible = d.visible;\n                return typeof visible === 'undefined' || visible === true;\n            });\n            var isStacked = false;\n            var dataWithGroupId = data.map(function(d, i) {\n                isStacked = isStacked || typeof d.groupId !== 'undefined';\n                return d;\n            });\n            if (isStacked) {\n                var grouped = d3.nest().key(function(d, i) {\n                    return typeof d.groupId != 'undefined' ? d.groupId : 'unstacked';\n                }).entries(dataWithGroupId);\n                var dataYStack = [];\n                var stacked = grouped.map(function(d, i) {\n                    if (d.key === 'unstacked') return d.values; else {\n                        var prevArray = d.values[0].r.map(function(d, i) {\n                            return 0;\n                        });\n                        d.values.forEach(function(d, i, a) {\n                            d.yStack = [ prevArray ];\n                            dataYStack.push(prevArray);\n                            prevArray = µ.util.sumArrays(d.r, prevArray);\n                        });\n                        return d.values;\n                    }\n                });\n                data = d3.merge(stacked);\n            }\n            data.forEach(function(d, i) {\n                d.t = Array.isArray(d.t[0]) ? d.t : [ d.t ];\n                d.r = Array.isArray(d.r[0]) ? d.r : [ d.r ];\n            });\n            var radius = Math.min(axisConfig.width - axisConfig.margin.left - axisConfig.margin.right, axisConfig.height - axisConfig.margin.top - axisConfig.margin.bottom) / 2;\n            radius = Math.max(10, radius);\n            var chartCenter = [ axisConfig.margin.left + radius, axisConfig.margin.top + radius ];\n            var extent;\n            if (isStacked) {\n                var highestStackedValue = d3.max(µ.util.sumArrays(µ.util.arrayLast(data).r[0], µ.util.arrayLast(dataYStack)));\n                extent = [ 0, highestStackedValue ];\n            } else extent = d3.extent(µ.util.flattenArray(data.map(function(d, i) {\n                return d.r;\n            })));\n            if (axisConfig.radialAxis.domain != µ.DATAEXTENT) extent[0] = 0;\n            radialScale = d3.scale.linear().domain(axisConfig.radialAxis.domain != µ.DATAEXTENT && axisConfig.radialAxis.domain ? axisConfig.radialAxis.domain : extent).range([ 0, radius ]);\n            liveConfig.layout.radialAxis.domain = radialScale.domain();\n            var angularDataMerged = µ.util.flattenArray(data.map(function(d, i) {\n                return d.t;\n            }));\n            var isOrdinal = typeof angularDataMerged[0] === 'string';\n            var ticks;\n            if (isOrdinal) {\n                angularDataMerged = µ.util.deduplicate(angularDataMerged);\n                ticks = angularDataMerged.slice();\n                angularDataMerged = d3.range(angularDataMerged.length);\n                data = data.map(function(d, i) {\n                    var result = d;\n                    d.t = [ angularDataMerged ];\n                    if (isStacked) result.yStack = d.yStack;\n                    return result;\n                });\n            }\n            var hasOnlyLineOrDotPlot = data.filter(function(d, i) {\n                return d.geometry === 'LinePlot' || d.geometry === 'DotPlot';\n            }).length === data.length;\n            var needsEndSpacing = axisConfig.needsEndSpacing === null ? isOrdinal || !hasOnlyLineOrDotPlot : axisConfig.needsEndSpacing;\n            var useProvidedDomain = axisConfig.angularAxis.domain && axisConfig.angularAxis.domain != µ.DATAEXTENT && !isOrdinal && axisConfig.angularAxis.domain[0] >= 0;\n            var angularDomain = useProvidedDomain ? axisConfig.angularAxis.domain : d3.extent(angularDataMerged);\n            var angularDomainStep = Math.abs(angularDataMerged[1] - angularDataMerged[0]);\n            if (hasOnlyLineOrDotPlot && !isOrdinal) angularDomainStep = 0;\n            var angularDomainWithPadding = angularDomain.slice();\n            if (needsEndSpacing && isOrdinal) angularDomainWithPadding[1] += angularDomainStep;\n            var tickCount = axisConfig.angularAxis.ticksCount || 4;\n            if (tickCount > 8) tickCount = tickCount / (tickCount / 8) + tickCount % 8;\n            if (axisConfig.angularAxis.ticksStep) {\n                tickCount = (angularDomainWithPadding[1] - angularDomainWithPadding[0]) / tickCount;\n            }\n            var angularTicksStep = axisConfig.angularAxis.ticksStep || (angularDomainWithPadding[1] - angularDomainWithPadding[0]) / (tickCount * (axisConfig.minorTicks + 1));\n            if (ticks) angularTicksStep = Math.max(Math.round(angularTicksStep), 1);\n            if (!angularDomainWithPadding[2]) angularDomainWithPadding[2] = angularTicksStep;\n            var angularAxisRange = d3.range.apply(this, angularDomainWithPadding);\n            angularAxisRange = angularAxisRange.map(function(d, i) {\n                return parseFloat(d.toPrecision(12));\n            });\n            angularScale = d3.scale.linear().domain(angularDomainWithPadding.slice(0, 2)).range(axisConfig.direction === 'clockwise' ? [ 0, 360 ] : [ 360, 0 ]);\n            liveConfig.layout.angularAxis.domain = angularScale.domain();\n            liveConfig.layout.angularAxis.endPadding = needsEndSpacing ? angularDomainStep : 0;\n            svg = d3.select(this).select('svg.chart-root');\n            if (typeof svg === 'undefined' || svg.empty()) {\n                var skeleton = \"<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'></circle>' + '<g class='geometry-group'></g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'></circle>' + '</g>' + '<g class='angular axis-group'></g>' + '<g class='guides-group'><line></line><circle r='0'></circle></g>' + '</g>' + '<g class='legend-group'></g>' + '<g class='tooltips-group'></g>' + '<g class='title-group'><text></text></g>' + '</g>' + '</svg>\";\n                var doc = new DOMParser().parseFromString(skeleton, 'application/xml');\n                var newSvg = this.appendChild(this.ownerDocument.importNode(doc.documentElement, true));\n                svg = d3.select(newSvg);\n            }\n            svg.select('.guides-group').style({\n                'pointer-events': 'none'\n            });\n            svg.select('.angular.axis-group').style({\n                'pointer-events': 'none'\n            });\n            svg.select('.radial.axis-group').style({\n                'pointer-events': 'none'\n            });\n            var chartGroup = svg.select('.chart-group');\n            var lineStyle = {\n                fill: 'none',\n                stroke: axisConfig.tickColor\n            };\n            var fontStyle = {\n                'font-size': axisConfig.font.size,\n                'font-family': axisConfig.font.family,\n                fill: axisConfig.font.color,\n                'text-shadow': [ '-1px 0px', '1px -1px', '-1px 1px', '1px 1px' ].map(function(d, i) {\n                    return ' ' + d + ' 0 ' + axisConfig.font.outlineColor;\n                }).join(',')\n            };\n            var legendContainer;\n            if (axisConfig.showLegend) {\n                legendContainer = svg.select('.legend-group').attr({\n                    transform: 'translate(' + [ radius, axisConfig.margin.top ] + ')'\n                }).style({\n                    display: 'block'\n                });\n                var elements = data.map(function(d, i) {\n                    var datumClone = µ.util.cloneJson(d);\n                    datumClone.symbol = d.geometry === 'DotPlot' ? d.dotType || 'circle' : d.geometry != 'LinePlot' ? 'square' : 'line';\n                    datumClone.visibleInLegend = typeof d.visibleInLegend === 'undefined' || d.visibleInLegend;\n                    datumClone.color = d.geometry === 'LinePlot' ? d.strokeColor : d.color;\n                    return datumClone;\n                });\n\n                µ.Legend().config({\n                    data: data.map(function(d, i) {\n                        return d.name || 'Element' + i;\n                    }),\n                    legendConfig: extendDeepAll({},\n                        µ.Legend.defaultConfig().legendConfig,\n                        {\n                            container: legendContainer,\n                            elements: elements,\n                            reverseOrder: axisConfig.legend.reverseOrder\n                        }\n                    )\n                })();\n\n                var legendBBox = legendContainer.node().getBBox();\n                radius = Math.min(axisConfig.width - legendBBox.width - axisConfig.margin.left - axisConfig.margin.right, axisConfig.height - axisConfig.margin.top - axisConfig.margin.bottom) / 2;\n                radius = Math.max(10, radius);\n                chartCenter = [ axisConfig.margin.left + radius, axisConfig.margin.top + radius ];\n                radialScale.range([ 0, radius ]);\n                liveConfig.layout.radialAxis.domain = radialScale.domain();\n                legendContainer.attr('transform', 'translate(' + [ chartCenter[0] + radius, chartCenter[1] - radius ] + ')');\n            } else {\n                legendContainer = svg.select('.legend-group').style({\n                    display: 'none'\n                });\n            }\n            svg.attr({\n                width: axisConfig.width,\n                height: axisConfig.height\n            }).style({\n                opacity: axisConfig.opacity\n            });\n            chartGroup.attr('transform', 'translate(' + chartCenter + ')').style({\n                cursor: 'crosshair'\n            });\n            var centeringOffset = [ (axisConfig.width - (axisConfig.margin.left + axisConfig.margin.right + radius * 2 + (legendBBox ? legendBBox.width : 0))) / 2, (axisConfig.height - (axisConfig.margin.top + axisConfig.margin.bottom + radius * 2)) / 2 ];\n            centeringOffset[0] = Math.max(0, centeringOffset[0]);\n            centeringOffset[1] = Math.max(0, centeringOffset[1]);\n            svg.select('.outer-group').attr('transform', 'translate(' + centeringOffset + ')');\n            if (axisConfig.title && axisConfig.title.text) {\n                var title = svg.select('g.title-group text').style(fontStyle).text(axisConfig.title.text);\n                var titleBBox = title.node().getBBox();\n                title.attr({\n                    x: chartCenter[0] - titleBBox.width / 2,\n                    y: chartCenter[1] - radius - 20\n                });\n            }\n            var radialAxis = svg.select('.radial.axis-group');\n            if (axisConfig.radialAxis.gridLinesVisible) {\n                var gridCircles = radialAxis.selectAll('circle.grid-circle').data(radialScale.ticks(5));\n                gridCircles.enter().append('circle').attr({\n                    'class': 'grid-circle'\n                }).style(lineStyle);\n                gridCircles.attr('r', radialScale);\n                gridCircles.exit().remove();\n            }\n            radialAxis.select('circle.outside-circle').attr({\n                r: radius\n            }).style(lineStyle);\n            var backgroundCircle = svg.select('circle.background-circle').attr({\n                r: radius\n            }).style({\n                fill: axisConfig.backgroundColor,\n                stroke: axisConfig.stroke\n            });\n            function currentAngle(d, i) {\n                return angularScale(d) % 360 + axisConfig.orientation;\n            }\n            if (axisConfig.radialAxis.visible) {\n                var axis = d3.svg.axis().scale(radialScale).ticks(5).tickSize(5);\n                radialAxis.call(axis).attr({\n                    transform: 'rotate(' + axisConfig.radialAxis.orientation + ')'\n                });\n                radialAxis.selectAll('.domain').style(lineStyle);\n                radialAxis.selectAll('g>text').text(function(d, i) {\n                    return this.textContent + axisConfig.radialAxis.ticksSuffix;\n                }).style(fontStyle).style({\n                    'text-anchor': 'start'\n                }).attr({\n                    x: 0,\n                    y: 0,\n                    dx: 0,\n                    dy: 0,\n                    transform: function(d, i) {\n                        if (axisConfig.radialAxis.tickOrientation === 'horizontal') {\n                            return 'rotate(' + -axisConfig.radialAxis.orientation + ') translate(' + [ 0, fontStyle['font-size'] ] + ')';\n                        } else return 'translate(' + [ 0, fontStyle['font-size'] ] + ')';\n                    }\n                });\n                radialAxis.selectAll('g>line').style({\n                    stroke: 'black'\n                });\n            }\n            var angularAxis = svg.select('.angular.axis-group').selectAll('g.angular-tick').data(angularAxisRange);\n            var angularAxisEnter = angularAxis.enter().append('g').classed('angular-tick', true);\n            angularAxis.attr({\n                transform: function(d, i) {\n                    return 'rotate(' + currentAngle(d, i) + ')';\n                }\n            }).style({\n                display: axisConfig.angularAxis.visible ? 'block' : 'none'\n            });\n            angularAxis.exit().remove();\n            angularAxisEnter.append('line').classed('grid-line', true).classed('major', function(d, i) {\n                return i % (axisConfig.minorTicks + 1) == 0;\n            }).classed('minor', function(d, i) {\n                return !(i % (axisConfig.minorTicks + 1) == 0);\n            }).style(lineStyle);\n            angularAxisEnter.selectAll('.minor').style({\n                stroke: axisConfig.minorTickColor\n            });\n            angularAxis.select('line.grid-line').attr({\n                x1: axisConfig.tickLength ? radius - axisConfig.tickLength : 0,\n                x2: radius\n            }).style({\n                display: axisConfig.angularAxis.gridLinesVisible ? 'block' : 'none'\n            });\n            angularAxisEnter.append('text').classed('axis-text', true).style(fontStyle);\n            var ticksText = angularAxis.select('text.axis-text').attr({\n                x: radius + axisConfig.labelOffset,\n                dy: MID_SHIFT + 'em',\n                transform: function(d, i) {\n                    var angle = currentAngle(d, i);\n                    var rad = radius + axisConfig.labelOffset;\n                    var orient = axisConfig.angularAxis.tickOrientation;\n                    if (orient == 'horizontal') return 'rotate(' + -angle + ' ' + rad + ' 0)'; else if (orient == 'radial') return angle < 270 && angle > 90 ? 'rotate(180 ' + rad + ' 0)' : null; else return 'rotate(' + (angle <= 180 && angle > 0 ? -90 : 90) + ' ' + rad + ' 0)';\n                }\n            }).style({\n                'text-anchor': 'middle',\n                display: axisConfig.angularAxis.labelsVisible ? 'block' : 'none'\n            }).text(function(d, i) {\n                if (i % (axisConfig.minorTicks + 1) != 0) return '';\n                if (ticks) {\n                    return ticks[d] + axisConfig.angularAxis.ticksSuffix;\n                } else return d + axisConfig.angularAxis.ticksSuffix;\n            }).style(fontStyle);\n            if (axisConfig.angularAxis.rewriteTicks) ticksText.text(function(d, i) {\n                if (i % (axisConfig.minorTicks + 1) != 0) return '';\n                return axisConfig.angularAxis.rewriteTicks(this.textContent, i);\n            });\n            var rightmostTickEndX = d3.max(chartGroup.selectAll('.angular-tick text')[0].map(function(d, i) {\n                return d.getCTM().e + d.getBBox().width;\n            }));\n            legendContainer.attr({\n                transform: 'translate(' + [ radius + rightmostTickEndX, axisConfig.margin.top ] + ')'\n            });\n            var hasGeometry = svg.select('g.geometry-group').selectAll('g').size() > 0;\n            var geometryContainer = svg.select('g.geometry-group').selectAll('g.geometry').data(data);\n            geometryContainer.enter().append('g').attr({\n                'class': function(d, i) {\n                    return 'geometry geometry' + i;\n                }\n            });\n            geometryContainer.exit().remove();\n            if (data[0] || hasGeometry) {\n                var geometryConfigs = [];\n                data.forEach(function(d, i) {\n                    var geometryConfig = {};\n                    geometryConfig.radialScale = radialScale;\n                    geometryConfig.angularScale = angularScale;\n                    geometryConfig.container = geometryContainer.filter(function(dB, iB) {\n                        return iB == i;\n                    });\n                    geometryConfig.geometry = d.geometry;\n                    geometryConfig.orientation = axisConfig.orientation;\n                    geometryConfig.direction = axisConfig.direction;\n                    geometryConfig.index = i;\n                    geometryConfigs.push({\n                        data: d,\n                        geometryConfig: geometryConfig\n                    });\n                });\n                var geometryConfigsGrouped = d3.nest().key(function(d, i) {\n                    return typeof d.data.groupId != 'undefined' || 'unstacked';\n                }).entries(geometryConfigs);\n                var geometryConfigsGrouped2 = [];\n                geometryConfigsGrouped.forEach(function(d, i) {\n                    if (d.key === 'unstacked') geometryConfigsGrouped2 = geometryConfigsGrouped2.concat(d.values.map(function(d, i) {\n                        return [ d ];\n                    })); else geometryConfigsGrouped2.push(d.values);\n                });\n                geometryConfigsGrouped2.forEach(function(d, i) {\n                    var geometry;\n                    if (Array.isArray(d)) geometry = d[0].geometryConfig.geometry; else geometry = d.geometryConfig.geometry;\n                    var finalGeometryConfig = d.map(function(dB, iB) {\n                        return extendDeepAll(µ[geometry].defaultConfig(), dB);\n                    });\n                    µ[geometry]().config(finalGeometryConfig)();\n                });\n            }\n            var guides = svg.select('.guides-group');\n            var tooltipContainer = svg.select('.tooltips-group');\n            var angularTooltip = µ.tooltipPanel().config({\n                container: tooltipContainer,\n                fontSize: 8\n            })();\n            var radialTooltip = µ.tooltipPanel().config({\n                container: tooltipContainer,\n                fontSize: 8\n            })();\n            var geometryTooltip = µ.tooltipPanel().config({\n                container: tooltipContainer,\n                hasTick: true\n            })();\n            var angularValue, radialValue;\n            if (!isOrdinal) {\n                var angularGuideLine = guides.select('line').attr({\n                    x1: 0,\n                    y1: 0,\n                    y2: 0\n                }).style({\n                    stroke: 'grey',\n                    'pointer-events': 'none'\n                });\n                chartGroup.on('mousemove.angular-guide', function(d, i) {\n                    var mouseAngle = µ.util.getMousePos(backgroundCircle).angle;\n                    angularGuideLine.attr({\n                        x2: -radius,\n                        transform: 'rotate(' + mouseAngle + ')'\n                    }).style({\n                        opacity: .5\n                    });\n                    var angleWithOriginOffset = (mouseAngle + 180 + 360 - axisConfig.orientation) % 360;\n                    angularValue = angularScale.invert(angleWithOriginOffset);\n                    var pos = µ.util.convertToCartesian(radius + 12, mouseAngle + 180);\n                    angularTooltip.text(µ.util.round(angularValue)).move([ pos[0] + chartCenter[0], pos[1] + chartCenter[1] ]);\n                }).on('mouseout.angular-guide', function(d, i) {\n                    guides.select('line').style({\n                        opacity: 0\n                    });\n                });\n            }\n            var angularGuideCircle = guides.select('circle').style({\n                stroke: 'grey',\n                fill: 'none'\n            });\n            chartGroup.on('mousemove.radial-guide', function(d, i) {\n                var r = µ.util.getMousePos(backgroundCircle).radius;\n                angularGuideCircle.attr({\n                    r: r\n                }).style({\n                    opacity: .5\n                });\n                radialValue = radialScale.invert(µ.util.getMousePos(backgroundCircle).radius);\n                var pos = µ.util.convertToCartesian(r, axisConfig.radialAxis.orientation);\n                radialTooltip.text(µ.util.round(radialValue)).move([ pos[0] + chartCenter[0], pos[1] + chartCenter[1] ]);\n            }).on('mouseout.radial-guide', function(d, i) {\n                angularGuideCircle.style({\n                    opacity: 0\n                });\n                geometryTooltip.hide();\n                angularTooltip.hide();\n                radialTooltip.hide();\n            });\n            svg.selectAll('.geometry-group .mark').on('mouseover.tooltip', function(d, i) {\n                var el = d3.select(this);\n                var color = this.style.fill;\n                var newColor = 'black';\n                var opacity = this.style.opacity || 1;\n                el.attr({\n                    'data-opacity': opacity\n                });\n                if (color && color !== 'none') {\n                    el.attr({\n                        'data-fill': color\n                    });\n                    newColor = d3.hsl(color).darker().toString();\n                    el.style({\n                        fill: newColor,\n                        opacity: 1\n                    });\n                    var textData = {\n                        t: µ.util.round(d[0]),\n                        r: µ.util.round(d[1])\n                    };\n                    if (isOrdinal) textData.t = ticks[d[0]];\n                    var text = 't: ' + textData.t + ', r: ' + textData.r;\n                    var bbox = this.getBoundingClientRect();\n                    var svgBBox = svg.node().getBoundingClientRect();\n                    var pos = [ bbox.left + bbox.width / 2 - centeringOffset[0] - svgBBox.left, bbox.top + bbox.height / 2 - centeringOffset[1] - svgBBox.top ];\n                    geometryTooltip.config({\n                        color: newColor\n                    }).text(text);\n                    geometryTooltip.move(pos);\n                } else {\n                    color = this.style.stroke || 'black';\n                    el.attr({\n                        'data-stroke': color\n                    });\n                    newColor = d3.hsl(color).darker().toString();\n                    el.style({\n                        stroke: newColor,\n                        opacity: 1\n                    });\n                }\n            }).on('mousemove.tooltip', function(d, i) {\n                if (d3.event.which != 0) return false;\n                if (d3.select(this).attr('data-fill')) geometryTooltip.show();\n            }).on('mouseout.tooltip', function(d, i) {\n                geometryTooltip.hide();\n                var el = d3.select(this);\n                var fillColor = el.attr('data-fill');\n                if (fillColor) el.style({\n                    fill: fillColor,\n                    opacity: el.attr('data-opacity')\n                }); else el.style({\n                    stroke: el.attr('data-stroke'),\n                    opacity: el.attr('data-opacity')\n                });\n            });\n        });\n        return exports;\n    }\n    exports.render = function(_container) {\n        render(_container);\n        return this;\n    };\n    exports.config = function(_x) {\n        if (!arguments.length) return config;\n        var xClone = µ.util.cloneJson(_x);\n        xClone.data.forEach(function(d, i) {\n            if (!config.data[i]) config.data[i] = {};\n            extendDeepAll(config.data[i], µ.Axis.defaultConfig().data[0]);\n            extendDeepAll(config.data[i], d);\n        });\n        extendDeepAll(config.layout, µ.Axis.defaultConfig().layout);\n        extendDeepAll(config.layout, xClone.layout);\n        return this;\n    };\n    exports.getLiveConfig = function() {\n        return liveConfig;\n    };\n    exports.getinputConfig = function() {\n        return inputConfig;\n    };\n    exports.radialScale = function(_x) {\n        return radialScale;\n    };\n    exports.angularScale = function(_x) {\n        return angularScale;\n    };\n    exports.svg = function() {\n        return svg;\n    };\n    d3.rebind(exports, dispatch, 'on');\n    return exports;\n};\n\nµ.Axis.defaultConfig = function(d, i) {\n    var config = {\n        data: [ {\n            t: [ 1, 2, 3, 4 ],\n            r: [ 10, 11, 12, 13 ],\n            name: 'Line1',\n            geometry: 'LinePlot',\n            color: null,\n            strokeDash: 'solid',\n            strokeColor: null,\n            strokeSize: '1',\n            visibleInLegend: true,\n            opacity: 1\n        } ],\n        layout: {\n            defaultColorRange: d3.scale.category10().range(),\n            title: null,\n            height: 450,\n            width: 500,\n            margin: {\n                top: 40,\n                right: 40,\n                bottom: 40,\n                left: 40\n            },\n            font: {\n                size: 12,\n                color: 'gray',\n                outlineColor: 'white',\n                family: 'Tahoma, sans-serif'\n            },\n            direction: 'clockwise',\n            orientation: 0,\n            labelOffset: 10,\n            radialAxis: {\n                domain: null,\n                orientation: -45,\n                ticksSuffix: '',\n                visible: true,\n                gridLinesVisible: true,\n                tickOrientation: 'horizontal',\n                rewriteTicks: null\n            },\n            angularAxis: {\n                domain: [ 0, 360 ],\n                ticksSuffix: '',\n                visible: true,\n                gridLinesVisible: true,\n                labelsVisible: true,\n                tickOrientation: 'horizontal',\n                rewriteTicks: null,\n                ticksCount: null,\n                ticksStep: null\n            },\n            minorTicks: 0,\n            tickLength: null,\n            tickColor: 'silver',\n            minorTickColor: '#eee',\n            backgroundColor: 'none',\n            needsEndSpacing: null,\n            showLegend: true,\n            legend: {\n                reverseOrder: false\n            },\n            opacity: 1\n        }\n    };\n    return config;\n};\n\nµ.util = {};\n\nµ.DATAEXTENT = 'dataExtent';\n\nµ.AREA = 'AreaChart';\n\nµ.LINE = 'LinePlot';\n\nµ.DOT = 'DotPlot';\n\nµ.BAR = 'BarChart';\n\nµ.util._override = function(_objA, _objB) {\n    for (var x in _objA) if (x in _objB) _objB[x] = _objA[x];\n};\n\nµ.util._extend = function(_objA, _objB) {\n    for (var x in _objA) _objB[x] = _objA[x];\n};\n\nµ.util._rndSnd = function() {\n    return Math.random() * 2 - 1 + (Math.random() * 2 - 1) + (Math.random() * 2 - 1);\n};\n\nµ.util.dataFromEquation2 = function(_equation, _step) {\n    var step = _step || 6;\n    var data = d3.range(0, 360 + step, step).map(function(deg, index) {\n        var theta = deg * Math.PI / 180;\n        var radius = _equation(theta);\n        return [ deg, radius ];\n    });\n    return data;\n};\n\nµ.util.dataFromEquation = function(_equation, _step, _name) {\n    var step = _step || 6;\n    var t = [], r = [];\n    d3.range(0, 360 + step, step).forEach(function(deg, index) {\n        var theta = deg * Math.PI / 180;\n        var radius = _equation(theta);\n        t.push(deg);\n        r.push(radius);\n    });\n    var result = {\n        t: t,\n        r: r\n    };\n    if (_name) result.name = _name;\n    return result;\n};\n\nµ.util.ensureArray = function(_val, _count) {\n    if (typeof _val === 'undefined') return null;\n    var arr = [].concat(_val);\n    return d3.range(_count).map(function(d, i) {\n        return arr[i] || arr[0];\n    });\n};\n\nµ.util.fillArrays = function(_obj, _valueNames, _count) {\n    _valueNames.forEach(function(d, i) {\n        _obj[d] = µ.util.ensureArray(_obj[d], _count);\n    });\n    return _obj;\n};\n\nµ.util.cloneJson = function(json) {\n    return JSON.parse(JSON.stringify(json));\n};\n\nµ.util.validateKeys = function(obj, keys) {\n    if (typeof keys === 'string') keys = keys.split('.');\n    var next = keys.shift();\n    return obj[next] && (!keys.length || objHasKeys(obj[next], keys));\n};\n\nµ.util.sumArrays = function(a, b) {\n    return d3.zip(a, b).map(function(d, i) {\n        return d3.sum(d);\n    });\n};\n\nµ.util.arrayLast = function(a) {\n    return a[a.length - 1];\n};\n\nµ.util.arrayEqual = function(a, b) {\n    var i = Math.max(a.length, b.length, 1);\n    while (i-- >= 0 && a[i] === b[i]) ;\n    return i === -2;\n};\n\nµ.util.flattenArray = function(arr) {\n    var r = [];\n    while (!µ.util.arrayEqual(r, arr)) {\n        r = arr;\n        arr = [].concat.apply([], arr);\n    }\n    return arr;\n};\n\nµ.util.deduplicate = function(arr) {\n    return arr.filter(function(v, i, a) {\n        return a.indexOf(v) == i;\n    });\n};\n\nµ.util.convertToCartesian = function(radius, theta) {\n    var thetaRadians = theta * Math.PI / 180;\n    var x = radius * Math.cos(thetaRadians);\n    var y = radius * Math.sin(thetaRadians);\n    return [ x, y ];\n};\n\nµ.util.round = function(_value, _digits) {\n    var digits = _digits || 2;\n    var mult = Math.pow(10, digits);\n    return Math.round(_value * mult) / mult;\n};\n\nµ.util.getMousePos = function(_referenceElement) {\n    var mousePos = d3.mouse(_referenceElement.node());\n    var mouseX = mousePos[0];\n    var mouseY = mousePos[1];\n    var mouse = {};\n    mouse.x = mouseX;\n    mouse.y = mouseY;\n    mouse.pos = mousePos;\n    mouse.angle = (Math.atan2(mouseY, mouseX) + Math.PI) * 180 / Math.PI;\n    mouse.radius = Math.sqrt(mouseX * mouseX + mouseY * mouseY);\n    return mouse;\n};\n\nµ.util.duplicatesCount = function(arr) {\n    var uniques = {}, val;\n    var dups = {};\n    for (var i = 0, len = arr.length; i < len; i++) {\n        val = arr[i];\n        if (val in uniques) {\n            uniques[val]++;\n            dups[val] = uniques[val];\n        } else {\n            uniques[val] = 1;\n        }\n    }\n    return dups;\n};\n\nµ.util.duplicates = function(arr) {\n    return Object.keys(µ.util.duplicatesCount(arr));\n};\n\nµ.util.translator = function(obj, sourceBranch, targetBranch, reverse) {\n    if (reverse) {\n        var targetBranchCopy = targetBranch.slice();\n        targetBranch = sourceBranch;\n        sourceBranch = targetBranchCopy;\n    }\n    var value = sourceBranch.reduce(function(previousValue, currentValue) {\n        if (typeof previousValue != 'undefined') return previousValue[currentValue];\n    }, obj);\n    if (typeof value === 'undefined') return;\n    sourceBranch.reduce(function(previousValue, currentValue, index) {\n        if (typeof previousValue == 'undefined') return;\n        if (index === sourceBranch.length - 1) delete previousValue[currentValue];\n        return previousValue[currentValue];\n    }, obj);\n    targetBranch.reduce(function(previousValue, currentValue, index) {\n        if (typeof previousValue[currentValue] === 'undefined') previousValue[currentValue] = {};\n        if (index === targetBranch.length - 1) previousValue[currentValue] = value;\n        return previousValue[currentValue];\n    }, obj);\n};\n\nµ.PolyChart = function module() {\n    var config = [ µ.PolyChart.defaultConfig() ];\n    var dispatch = d3.dispatch('hover');\n    var dashArray = {\n        solid: 'none',\n        dash: [ 5, 2 ],\n        dot: [ 2, 5 ]\n    };\n    var colorScale;\n    function exports() {\n        var geometryConfig = config[0].geometryConfig;\n        var container = geometryConfig.container;\n        if (typeof container == 'string') container = d3.select(container);\n        container.datum(config).each(function(_config, _index) {\n            var isStack = !!_config[0].data.yStack;\n            var data = _config.map(function(d, i) {\n                if (isStack) return d3.zip(d.data.t[0], d.data.r[0], d.data.yStack[0]); else return d3.zip(d.data.t[0], d.data.r[0]);\n            });\n            var angularScale = geometryConfig.angularScale;\n            var domainMin = geometryConfig.radialScale.domain()[0];\n            var generator = {};\n            generator.bar = function(d, i, pI) {\n                var dataConfig = _config[pI].data;\n                var h = geometryConfig.radialScale(d[1]) - geometryConfig.radialScale(0);\n                var stackTop = geometryConfig.radialScale(d[2] || 0);\n                var w = dataConfig.barWidth;\n                d3.select(this).attr({\n                    'class': 'mark bar',\n                    d: 'M' + [ [ h + stackTop, -w / 2 ], [ h + stackTop, w / 2 ], [ stackTop, w / 2 ], [ stackTop, -w / 2 ] ].join('L') + 'Z',\n                    transform: function(d, i) {\n                        return 'rotate(' + (geometryConfig.orientation + angularScale(d[0])) + ')';\n                    }\n                });\n            };\n            generator.dot = function(d, i, pI) {\n                var stackedData = d[2] ? [ d[0], d[1] + d[2] ] : d;\n                var symbol = d3.svg.symbol().size(_config[pI].data.dotSize).type(_config[pI].data.dotType)(d, i);\n                d3.select(this).attr({\n                    'class': 'mark dot',\n                    d: symbol,\n                    transform: function(d, i) {\n                        var coord = convertToCartesian(getPolarCoordinates(stackedData));\n                        return 'translate(' + [ coord.x, coord.y ] + ')';\n                    }\n                });\n            };\n            var line = d3.svg.line.radial().interpolate(_config[0].data.lineInterpolation).radius(function(d) {\n                return geometryConfig.radialScale(d[1]);\n            }).angle(function(d) {\n                return geometryConfig.angularScale(d[0]) * Math.PI / 180;\n            });\n            generator.line = function(d, i, pI) {\n                var lineData = d[2] ? data[pI].map(function(d, i) {\n                    return [ d[0], d[1] + d[2] ];\n                }) : data[pI];\n                d3.select(this).each(generator['dot']).style({\n                    opacity: function(dB, iB) {\n                        return +_config[pI].data.dotVisible;\n                    },\n                    fill: markStyle.stroke(d, i, pI)\n                }).attr({\n                    'class': 'mark dot'\n                });\n                if (i > 0) return;\n                var lineSelection = d3.select(this.parentNode).selectAll('path.line').data([ 0 ]);\n                lineSelection.enter().insert('path');\n                lineSelection.attr({\n                    'class': 'line',\n                    d: line(lineData),\n                    transform: function(dB, iB) {\n                        return 'rotate(' + (geometryConfig.orientation + 90) + ')';\n                    },\n                    'pointer-events': 'none'\n                }).style({\n                    fill: function(dB, iB) {\n                        return markStyle.fill(d, i, pI);\n                    },\n                    'fill-opacity': 0,\n                    stroke: function(dB, iB) {\n                        return markStyle.stroke(d, i, pI);\n                    },\n                    'stroke-width': function(dB, iB) {\n                        return markStyle['stroke-width'](d, i, pI);\n                    },\n                    'stroke-dasharray': function(dB, iB) {\n                        return markStyle['stroke-dasharray'](d, i, pI);\n                    },\n                    opacity: function(dB, iB) {\n                        return markStyle.opacity(d, i, pI);\n                    },\n                    display: function(dB, iB) {\n                        return markStyle.display(d, i, pI);\n                    }\n                });\n            };\n            var angularRange = geometryConfig.angularScale.range();\n            var triangleAngle = Math.abs(angularRange[1] - angularRange[0]) / data[0].length * Math.PI / 180;\n            var arc = d3.svg.arc().startAngle(function(d) {\n                return -triangleAngle / 2;\n            }).endAngle(function(d) {\n                return triangleAngle / 2;\n            }).innerRadius(function(d) {\n                return geometryConfig.radialScale(domainMin + (d[2] || 0));\n            }).outerRadius(function(d) {\n                return geometryConfig.radialScale(domainMin + (d[2] || 0)) + geometryConfig.radialScale(d[1]);\n            });\n            generator.arc = function(d, i, pI) {\n                d3.select(this).attr({\n                    'class': 'mark arc',\n                    d: arc,\n                    transform: function(d, i) {\n                        return 'rotate(' + (geometryConfig.orientation + angularScale(d[0]) + 90) + ')';\n                    }\n                });\n            };\n            var markStyle = {\n                fill: function(d, i, pI) {\n                    return _config[pI].data.color;\n                },\n                stroke: function(d, i, pI) {\n                    return _config[pI].data.strokeColor;\n                },\n                'stroke-width': function(d, i, pI) {\n                    return _config[pI].data.strokeSize + 'px';\n                },\n                'stroke-dasharray': function(d, i, pI) {\n                    return dashArray[_config[pI].data.strokeDash];\n                },\n                opacity: function(d, i, pI) {\n                    return _config[pI].data.opacity;\n                },\n                display: function(d, i, pI) {\n                    return typeof _config[pI].data.visible === 'undefined' || _config[pI].data.visible ? 'block' : 'none';\n                }\n            };\n            var geometryLayer = d3.select(this).selectAll('g.layer').data(data);\n            geometryLayer.enter().append('g').attr({\n                'class': 'layer'\n            });\n            var geometry = geometryLayer.selectAll('path.mark').data(function(d, i) {\n                return d;\n            });\n            geometry.enter().append('path').attr({\n                'class': 'mark'\n            });\n            geometry.style(markStyle).each(generator[geometryConfig.geometryType]);\n            geometry.exit().remove();\n            geometryLayer.exit().remove();\n            function getPolarCoordinates(d, i) {\n                var r = geometryConfig.radialScale(d[1]);\n                var t = (geometryConfig.angularScale(d[0]) + geometryConfig.orientation) * Math.PI / 180;\n                return {\n                    r: r,\n                    t: t\n                };\n            }\n            function convertToCartesian(polarCoordinates) {\n                var x = polarCoordinates.r * Math.cos(polarCoordinates.t);\n                var y = polarCoordinates.r * Math.sin(polarCoordinates.t);\n                return {\n                    x: x,\n                    y: y\n                };\n            }\n        });\n    }\n    exports.config = function(_x) {\n        if (!arguments.length) return config;\n        _x.forEach(function(d, i) {\n            if (!config[i]) config[i] = {};\n            extendDeepAll(config[i], µ.PolyChart.defaultConfig());\n            extendDeepAll(config[i], d);\n        });\n        return this;\n    };\n    exports.getColorScale = function() {\n        return colorScale;\n    };\n    d3.rebind(exports, dispatch, 'on');\n    return exports;\n};\n\nµ.PolyChart.defaultConfig = function() {\n    var config = {\n        data: {\n            name: 'geom1',\n            t: [ [ 1, 2, 3, 4 ] ],\n            r: [ [ 1, 2, 3, 4 ] ],\n            dotType: 'circle',\n            dotSize: 64,\n            dotVisible: false,\n            barWidth: 20,\n            color: '#ffa500',\n            strokeSize: 1,\n            strokeColor: 'silver',\n            strokeDash: 'solid',\n            opacity: 1,\n            index: 0,\n            visible: true,\n            visibleInLegend: true\n        },\n        geometryConfig: {\n            geometry: 'LinePlot',\n            geometryType: 'arc',\n            direction: 'clockwise',\n            orientation: 0,\n            container: 'body',\n            radialScale: null,\n            angularScale: null,\n            colorScale: d3.scale.category20()\n        }\n    };\n    return config;\n};\n\nµ.BarChart = function module() {\n    return µ.PolyChart();\n};\n\nµ.BarChart.defaultConfig = function() {\n    var config = {\n        geometryConfig: {\n            geometryType: 'bar'\n        }\n    };\n    return config;\n};\n\nµ.AreaChart = function module() {\n    return µ.PolyChart();\n};\n\nµ.AreaChart.defaultConfig = function() {\n    var config = {\n        geometryConfig: {\n            geometryType: 'arc'\n        }\n    };\n    return config;\n};\n\nµ.DotPlot = function module() {\n    return µ.PolyChart();\n};\n\nµ.DotPlot.defaultConfig = function() {\n    var config = {\n        geometryConfig: {\n            geometryType: 'dot',\n            dotType: 'circle'\n        }\n    };\n    return config;\n};\n\nµ.LinePlot = function module() {\n    return µ.PolyChart();\n};\n\nµ.LinePlot.defaultConfig = function() {\n    var config = {\n        geometryConfig: {\n            geometryType: 'line'\n        }\n    };\n    return config;\n};\n\nµ.Legend = function module() {\n    var config = µ.Legend.defaultConfig();\n    var dispatch = d3.dispatch('hover');\n    function exports() {\n        var legendConfig = config.legendConfig;\n        var flattenData = config.data.map(function(d, i) {\n            return [].concat(d).map(function(dB, iB) {\n                var element = extendDeepAll({}, legendConfig.elements[i]);\n                element.name = dB;\n                element.color = [].concat(legendConfig.elements[i].color)[iB];\n                return element;\n            });\n        });\n        var data = d3.merge(flattenData);\n        data = data.filter(function(d, i) {\n            return legendConfig.elements[i] && (legendConfig.elements[i].visibleInLegend || typeof legendConfig.elements[i].visibleInLegend === 'undefined');\n        });\n        if (legendConfig.reverseOrder) data = data.reverse();\n        var container = legendConfig.container;\n        if (typeof container == 'string' || container.nodeName) container = d3.select(container);\n        var colors = data.map(function(d, i) {\n            return d.color;\n        });\n        var lineHeight = legendConfig.fontSize;\n        var isContinuous = legendConfig.isContinuous == null ? typeof data[0] === 'number' : legendConfig.isContinuous;\n        var height = isContinuous ? legendConfig.height : lineHeight * data.length;\n        var legendContainerGroup = container.classed('legend-group', true);\n        var svg = legendContainerGroup.selectAll('svg').data([ 0 ]);\n        var svgEnter = svg.enter().append('svg').attr({\n            width: 300,\n            height: height + lineHeight,\n            xmlns: 'http://www.w3.org/2000/svg',\n            'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n            version: '1.1'\n        });\n        svgEnter.append('g').classed('legend-axis', true);\n        svgEnter.append('g').classed('legend-marks', true);\n        var dataNumbered = d3.range(data.length);\n        var colorScale = d3.scale[isContinuous ? 'linear' : 'ordinal']().domain(dataNumbered).range(colors);\n        var dataScale = d3.scale[isContinuous ? 'linear' : 'ordinal']().domain(dataNumbered)[isContinuous ? 'range' : 'rangePoints']([ 0, height ]);\n        var shapeGenerator = function(_type, _size) {\n            var squareSize = _size * 3;\n            if (_type === 'line') {\n                return 'M' + [ [ -_size / 2, -_size / 12 ], [ _size / 2, -_size / 12 ], [ _size / 2, _size / 12 ], [ -_size / 2, _size / 12 ] ] + 'Z';\n            } else if (d3.svg.symbolTypes.indexOf(_type) != -1) return d3.svg.symbol().type(_type).size(squareSize)(); else return d3.svg.symbol().type('square').size(squareSize)();\n        };\n        if (isContinuous) {\n            var gradient = svg.select('.legend-marks').append('defs').append('linearGradient').attr({\n                id: 'grad1',\n                x1: '0%',\n                y1: '0%',\n                x2: '0%',\n                y2: '100%'\n            }).selectAll('stop').data(colors);\n            gradient.enter().append('stop');\n            gradient.attr({\n                offset: function(d, i) {\n                    return i / (colors.length - 1) * 100 + '%';\n                }\n            }).style({\n                'stop-color': function(d, i) {\n                    return d;\n                }\n            });\n            svg.append('rect').classed('legend-mark', true).attr({\n                height: legendConfig.height,\n                width: legendConfig.colorBandWidth,\n                fill: 'url(#grad1)'\n            });\n        } else {\n            var legendElement = svg.select('.legend-marks').selectAll('path.legend-mark').data(data);\n            legendElement.enter().append('path').classed('legend-mark', true);\n            legendElement.attr({\n                transform: function(d, i) {\n                    return 'translate(' + [ lineHeight / 2, dataScale(i) + lineHeight / 2 ] + ')';\n                },\n                d: function(d, i) {\n                    var symbolType = d.symbol;\n                    return shapeGenerator(symbolType, lineHeight);\n                },\n                fill: function(d, i) {\n                    return colorScale(i);\n                }\n            });\n            legendElement.exit().remove();\n        }\n        var legendAxis = d3.svg.axis().scale(dataScale).orient('right');\n        var axis = svg.select('g.legend-axis').attr({\n            transform: 'translate(' + [ isContinuous ? legendConfig.colorBandWidth : lineHeight, lineHeight / 2 ] + ')'\n        }).call(legendAxis);\n        axis.selectAll('.domain').style({\n            fill: 'none',\n            stroke: 'none'\n        });\n        axis.selectAll('line').style({\n            fill: 'none',\n            stroke: isContinuous ? legendConfig.textColor : 'none'\n        });\n        axis.selectAll('text').style({\n            fill: legendConfig.textColor,\n            'font-size': legendConfig.fontSize\n        }).text(function(d, i) {\n            return data[i].name;\n        });\n        return exports;\n    }\n    exports.config = function(_x) {\n        if (!arguments.length) return config;\n        extendDeepAll(config, _x);\n        return this;\n    };\n    d3.rebind(exports, dispatch, 'on');\n    return exports;\n};\n\nµ.Legend.defaultConfig = function(d, i) {\n    var config = {\n        data: [ 'a', 'b', 'c' ],\n        legendConfig: {\n            elements: [ {\n                symbol: 'line',\n                color: 'red'\n            }, {\n                symbol: 'square',\n                color: 'yellow'\n            }, {\n                symbol: 'diamond',\n                color: 'limegreen'\n            } ],\n            height: 150,\n            colorBandWidth: 30,\n            fontSize: 12,\n            container: 'body',\n            isContinuous: null,\n            textColor: 'grey',\n            reverseOrder: false\n        }\n    };\n    return config;\n};\n\nµ.tooltipPanel = function() {\n    var tooltipEl, tooltipTextEl, backgroundEl;\n    var config = {\n        container: null,\n        hasTick: false,\n        fontSize: 12,\n        color: 'white',\n        padding: 5\n    };\n    var id = 'tooltip-' + µ.tooltipPanel.uid++;\n    var tickSize = 10;\n    var exports = function() {\n        tooltipEl = config.container.selectAll('g.' + id).data([ 0 ]);\n        var tooltipEnter = tooltipEl.enter().append('g').classed(id, true).style({\n            'pointer-events': 'none',\n            display: 'none'\n        });\n        backgroundEl = tooltipEnter.append('path').style({\n            fill: 'white',\n            'fill-opacity': .9\n        }).attr({\n            d: 'M0 0'\n        });\n        tooltipTextEl = tooltipEnter.append('text').attr({\n            dx: config.padding + tickSize,\n            dy: +config.fontSize * .3\n        });\n        return exports;\n    };\n    exports.text = function(_text) {\n        var l = d3.hsl(config.color).l;\n        var strokeColor = l >= .5 ? '#aaa' : 'white';\n        var fillColor = l >= .5 ? 'black' : 'white';\n        var text = _text || '';\n        tooltipTextEl.style({\n            fill: fillColor,\n            'font-size': config.fontSize + 'px'\n        }).text(text);\n        var padding = config.padding;\n        var bbox = tooltipTextEl.node().getBBox();\n        var boxStyle = {\n            fill: config.color,\n            stroke: strokeColor,\n            'stroke-width': '2px'\n        };\n        var backGroundW = bbox.width + padding * 2 + tickSize;\n        var backGroundH = bbox.height + padding * 2;\n        backgroundEl.attr({\n            d: 'M' + [ [ tickSize, -backGroundH / 2 ], [ tickSize, -backGroundH / 4 ], [ config.hasTick ? 0 : tickSize, 0 ], [ tickSize, backGroundH / 4 ], [ tickSize, backGroundH / 2 ], [ backGroundW, backGroundH / 2 ], [ backGroundW, -backGroundH / 2 ] ].join('L') + 'Z'\n        }).style(boxStyle);\n        tooltipEl.attr({\n            transform: 'translate(' + [ tickSize, -backGroundH / 2 + padding * 2 ] + ')'\n        });\n        tooltipEl.style({\n            display: 'block'\n        });\n        return exports;\n    };\n    exports.move = function(_pos) {\n        if (!tooltipEl) return;\n        tooltipEl.attr({\n            transform: 'translate(' + [ _pos[0], _pos[1] ] + ')'\n        }).style({\n            display: 'block'\n        });\n        return exports;\n    };\n    exports.hide = function() {\n        if (!tooltipEl) return;\n        tooltipEl.style({\n            display: 'none'\n        });\n        return exports;\n    };\n    exports.show = function() {\n        if (!tooltipEl) return;\n        tooltipEl.style({\n            display: 'block'\n        });\n        return exports;\n    };\n    exports.config = function(_x) {\n        extendDeepAll(config, _x);\n        return exports;\n    };\n    return exports;\n};\n\nµ.tooltipPanel.uid = 1;\n\nµ.adapter = {};\n\nµ.adapter.plotly = function module() {\n    var exports = {};\n    exports.convert = function(_inputConfig, reverse) {\n        var outputConfig = {};\n        if (_inputConfig.data) {\n            outputConfig.data = _inputConfig.data.map(function(d, i) {\n                var r = extendDeepAll({}, d);\n                var toTranslate = [\n                    [ r, [ 'marker', 'color' ], [ 'color' ] ],\n                    [ r, [ 'marker', 'opacity' ], [ 'opacity' ] ],\n                    [ r, [ 'marker', 'line', 'color' ], [ 'strokeColor' ] ],\n                    [ r, [ 'marker', 'line', 'dash' ], [ 'strokeDash' ] ],\n                    [ r, [ 'marker', 'line', 'width' ], [ 'strokeSize' ] ],\n                    [ r, [ 'marker', 'symbol' ], [ 'dotType' ] ],\n                    [ r, [ 'marker', 'size' ], [ 'dotSize' ] ],\n                    [ r, [ 'marker', 'barWidth' ], [ 'barWidth' ] ],\n                    [ r, [ 'line', 'interpolation' ], [ 'lineInterpolation' ] ],\n                    [ r, [ 'showlegend' ], [ 'visibleInLegend' ] ]\n                ];\n                toTranslate.forEach(function(d, i) {\n                    µ.util.translator.apply(null, d.concat(reverse));\n                });\n\n                if (!reverse) delete r.marker;\n                if (reverse) delete r.groupId;\n                if (!reverse) {\n                    if (r.type === 'scatter') {\n                        if (r.mode === 'lines') r.geometry = 'LinePlot'; else if (r.mode === 'markers') r.geometry = 'DotPlot'; else if (r.mode === 'lines+markers') {\n                            r.geometry = 'LinePlot';\n                            r.dotVisible = true;\n                        }\n                    } else if (r.type === 'area') r.geometry = 'AreaChart'; else if (r.type === 'bar') r.geometry = 'BarChart';\n                    delete r.mode;\n                    delete r.type;\n                } else {\n                    if (r.geometry === 'LinePlot') {\n                        r.type = 'scatter';\n                        if (r.dotVisible === true) {\n                            delete r.dotVisible;\n                            r.mode = 'lines+markers';\n                        } else r.mode = 'lines';\n                    } else if (r.geometry === 'DotPlot') {\n                        r.type = 'scatter';\n                        r.mode = 'markers';\n                    } else if (r.geometry === 'AreaChart') r.type = 'area'; else if (r.geometry === 'BarChart') r.type = 'bar';\n                    delete r.geometry;\n                }\n                return r;\n            });\n            if (!reverse && _inputConfig.layout && _inputConfig.layout.barmode === 'stack') {\n                var duplicates = µ.util.duplicates(outputConfig.data.map(function(d, i) {\n                    return d.geometry;\n                }));\n                outputConfig.data.forEach(function(d, i) {\n                    var idx = duplicates.indexOf(d.geometry);\n                    if (idx != -1) outputConfig.data[i].groupId = idx;\n                });\n            }\n        }\n        if (_inputConfig.layout) {\n            var r = extendDeepAll({}, _inputConfig.layout);\n            var toTranslate = [\n                [ r, [ 'plot_bgcolor' ], [ 'backgroundColor' ] ],\n                [ r, [ 'showlegend' ], [ 'showLegend' ] ],\n                [ r, [ 'radialaxis' ], [ 'radialAxis' ] ],\n                [ r, [ 'angularaxis' ], [ 'angularAxis' ] ],\n                [ r.angularaxis, [ 'showline' ], [ 'gridLinesVisible' ] ],\n                [ r.angularaxis, [ 'showticklabels' ], [ 'labelsVisible' ] ],\n                [ r.angularaxis, [ 'nticks' ], [ 'ticksCount' ] ],\n                [ r.angularaxis, [ 'tickorientation' ], [ 'tickOrientation' ] ],\n                [ r.angularaxis, [ 'ticksuffix' ], [ 'ticksSuffix' ] ],\n                [ r.angularaxis, [ 'range' ], [ 'domain' ] ],\n                [ r.angularaxis, [ 'endpadding' ], [ 'endPadding' ] ],\n                [ r.radialaxis, [ 'showline' ], [ 'gridLinesVisible' ] ],\n                [ r.radialaxis, [ 'tickorientation' ], [ 'tickOrientation' ] ],\n                [ r.radialaxis, [ 'ticksuffix' ], [ 'ticksSuffix' ] ],\n                [ r.radialaxis, [ 'range' ], [ 'domain' ] ],\n                [ r.angularAxis, [ 'showline' ], [ 'gridLinesVisible' ] ],\n                [ r.angularAxis, [ 'showticklabels' ], [ 'labelsVisible' ] ],\n                [ r.angularAxis, [ 'nticks' ], [ 'ticksCount' ] ],\n                [ r.angularAxis, [ 'tickorientation' ], [ 'tickOrientation' ] ],\n                [ r.angularAxis, [ 'ticksuffix' ], [ 'ticksSuffix' ] ],\n                [ r.angularAxis, [ 'range' ], [ 'domain' ] ],\n                [ r.angularAxis, [ 'endpadding' ], [ 'endPadding' ] ],\n                [ r.radialAxis, [ 'showline' ], [ 'gridLinesVisible' ] ],\n                [ r.radialAxis, [ 'tickorientation' ], [ 'tickOrientation' ] ],\n                [ r.radialAxis, [ 'ticksuffix' ], [ 'ticksSuffix' ] ],\n                [ r.radialAxis, [ 'range' ], [ 'domain' ] ],\n                [ r.font, [ 'outlinecolor' ], [ 'outlineColor' ] ],\n                [ r.legend, [ 'traceorder' ], [ 'reverseOrder' ] ],\n                [ r, [ 'labeloffset' ], [ 'labelOffset' ] ],\n                [ r, [ 'defaultcolorrange' ], [ 'defaultColorRange' ] ]\n            ];\n            toTranslate.forEach(function(d, i) {\n                µ.util.translator.apply(null, d.concat(reverse));\n            });\n\n            if (!reverse) {\n                if (r.angularAxis && typeof r.angularAxis.ticklen !== 'undefined') r.tickLength = r.angularAxis.ticklen;\n                if (r.angularAxis && typeof r.angularAxis.tickcolor !== 'undefined') r.tickColor = r.angularAxis.tickcolor;\n            } else {\n                if (typeof r.tickLength !== 'undefined') {\n                    r.angularaxis.ticklen = r.tickLength;\n                    delete r.tickLength;\n                }\n                if (r.tickColor) {\n                    r.angularaxis.tickcolor = r.tickColor;\n                    delete r.tickColor;\n                }\n            }\n            if (r.legend && typeof r.legend.reverseOrder != 'boolean') {\n                r.legend.reverseOrder = r.legend.reverseOrder != 'normal';\n            }\n            if (r.legend && typeof r.legend.traceorder == 'boolean') {\n                r.legend.traceorder = r.legend.traceorder ? 'reversed' : 'normal';\n                delete r.legend.reverseOrder;\n            }\n            if (r.margin && typeof r.margin.t != 'undefined') {\n                var source = [ 't', 'r', 'b', 'l', 'pad' ];\n                var target = [ 'top', 'right', 'bottom', 'left', 'pad' ];\n                var margin = {};\n                d3.entries(r.margin).forEach(function(dB, iB) {\n                    margin[target[source.indexOf(dB.key)]] = dB.value;\n                });\n                r.margin = margin;\n            }\n            if (reverse) {\n                delete r.needsEndSpacing;\n                delete r.minorTickColor;\n                delete r.minorTicks;\n                delete r.angularaxis.ticksCount;\n                delete r.angularaxis.ticksCount;\n                delete r.angularaxis.ticksStep;\n                delete r.angularaxis.rewriteTicks;\n                delete r.angularaxis.nticks;\n                delete r.radialaxis.ticksCount;\n                delete r.radialaxis.ticksCount;\n                delete r.radialaxis.ticksStep;\n                delete r.radialaxis.rewriteTicks;\n                delete r.radialaxis.nticks;\n            }\n            outputConfig.layout = r;\n        }\n        return outputConfig;\n    };\n    return exports;\n};\n"]},"metadata":{},"sourceType":"script"}