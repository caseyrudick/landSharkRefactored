{"ast":null,"code":"\"use strict\";\n\nvar twoProduct = require(\"two-product\");\n\nvar robustSum = require(\"robust-sum\");\n\nvar robustScale = require(\"robust-scale\");\n\nvar robustSubtract = require(\"robust-subtract\");\n\nvar NUM_EXPAND = 5;\nvar EPSILON = 1.1102230246251565e-16;\nvar ERRBOUND3 = (3.0 + 16.0 * EPSILON) * EPSILON;\nvar ERRBOUND4 = (7.0 + 56.0 * EPSILON) * EPSILON;\n\nfunction cofactor(m, c) {\n  var result = new Array(m.length - 1);\n\n  for (var i = 1; i < m.length; ++i) {\n    var r = result[i - 1] = new Array(m.length - 1);\n\n    for (var j = 0, k = 0; j < m.length; ++j) {\n      if (j === c) {\n        continue;\n      }\n\n      r[k++] = m[i][j];\n    }\n  }\n\n  return result;\n}\n\nfunction matrix(n) {\n  var result = new Array(n);\n\n  for (var i = 0; i < n; ++i) {\n    result[i] = new Array(n);\n\n    for (var j = 0; j < n; ++j) {\n      result[i][j] = [\"m\", j, \"[\", n - i - 1, \"]\"].join(\"\");\n    }\n  }\n\n  return result;\n}\n\nfunction sign(n) {\n  if (n & 1) {\n    return \"-\";\n  }\n\n  return \"\";\n}\n\nfunction generateSum(expr) {\n  if (expr.length === 1) {\n    return expr[0];\n  } else if (expr.length === 2) {\n    return [\"sum(\", expr[0], \",\", expr[1], \")\"].join(\"\");\n  } else {\n    var m = expr.length >> 1;\n    return [\"sum(\", generateSum(expr.slice(0, m)), \",\", generateSum(expr.slice(m)), \")\"].join(\"\");\n  }\n}\n\nfunction determinant(m) {\n  if (m.length === 2) {\n    return [[\"sum(prod(\", m[0][0], \",\", m[1][1], \"),prod(-\", m[0][1], \",\", m[1][0], \"))\"].join(\"\")];\n  } else {\n    var expr = [];\n\n    for (var i = 0; i < m.length; ++i) {\n      expr.push([\"scale(\", generateSum(determinant(cofactor(m, i))), \",\", sign(i), m[0][i], \")\"].join(\"\"));\n    }\n\n    return expr;\n  }\n}\n\nfunction orientation(n) {\n  var pos = [];\n  var neg = [];\n  var m = matrix(n);\n  var args = [];\n\n  for (var i = 0; i < n; ++i) {\n    if ((i & 1) === 0) {\n      pos.push.apply(pos, determinant(cofactor(m, i)));\n    } else {\n      neg.push.apply(neg, determinant(cofactor(m, i)));\n    }\n\n    args.push(\"m\" + i);\n  }\n\n  var posExpr = generateSum(pos);\n  var negExpr = generateSum(neg);\n  var funcName = \"orientation\" + n + \"Exact\";\n  var code = [\"function \", funcName, \"(\", args.join(), \"){var p=\", posExpr, \",n=\", negExpr, \",d=sub(p,n);\\\nreturn d[d.length-1];};return \", funcName].join(\"\");\n  var proc = new Function(\"sum\", \"prod\", \"scale\", \"sub\", code);\n  return proc(robustSum, twoProduct, robustScale, robustSubtract);\n}\n\nvar orientation3Exact = orientation(3);\nvar orientation4Exact = orientation(4);\nvar CACHED = [function orientation0() {\n  return 0;\n}, function orientation1() {\n  return 0;\n}, function orientation2(a, b) {\n  return b[0] - a[0];\n}, function orientation3(a, b, c) {\n  var l = (a[1] - c[1]) * (b[0] - c[0]);\n  var r = (a[0] - c[0]) * (b[1] - c[1]);\n  var det = l - r;\n  var s;\n\n  if (l > 0) {\n    if (r <= 0) {\n      return det;\n    } else {\n      s = l + r;\n    }\n  } else if (l < 0) {\n    if (r >= 0) {\n      return det;\n    } else {\n      s = -(l + r);\n    }\n  } else {\n    return det;\n  }\n\n  var tol = ERRBOUND3 * s;\n\n  if (det >= tol || det <= -tol) {\n    return det;\n  }\n\n  return orientation3Exact(a, b, c);\n}, function orientation4(a, b, c, d) {\n  var adx = a[0] - d[0];\n  var bdx = b[0] - d[0];\n  var cdx = c[0] - d[0];\n  var ady = a[1] - d[1];\n  var bdy = b[1] - d[1];\n  var cdy = c[1] - d[1];\n  var adz = a[2] - d[2];\n  var bdz = b[2] - d[2];\n  var cdz = c[2] - d[2];\n  var bdxcdy = bdx * cdy;\n  var cdxbdy = cdx * bdy;\n  var cdxady = cdx * ady;\n  var adxcdy = adx * cdy;\n  var adxbdy = adx * bdy;\n  var bdxady = bdx * ady;\n  var det = adz * (bdxcdy - cdxbdy) + bdz * (cdxady - adxcdy) + cdz * (adxbdy - bdxady);\n  var permanent = (Math.abs(bdxcdy) + Math.abs(cdxbdy)) * Math.abs(adz) + (Math.abs(cdxady) + Math.abs(adxcdy)) * Math.abs(bdz) + (Math.abs(adxbdy) + Math.abs(bdxady)) * Math.abs(cdz);\n  var tol = ERRBOUND4 * permanent;\n\n  if (det > tol || -det > tol) {\n    return det;\n  }\n\n  return orientation4Exact(a, b, c, d);\n}];\n\nfunction slowOrient(args) {\n  var proc = CACHED[args.length];\n\n  if (!proc) {\n    proc = CACHED[args.length] = orientation(args.length);\n  }\n\n  return proc.apply(undefined, args);\n}\n\nfunction generateOrientationProc() {\n  while (CACHED.length <= NUM_EXPAND) {\n    CACHED.push(orientation(CACHED.length));\n  }\n\n  var args = [];\n  var procArgs = [\"slow\"];\n\n  for (var i = 0; i <= NUM_EXPAND; ++i) {\n    args.push(\"a\" + i);\n    procArgs.push(\"o\" + i);\n  }\n\n  var code = [\"function getOrientation(\", args.join(), \"){switch(arguments.length){case 0:case 1:return 0;\"];\n\n  for (var i = 2; i <= NUM_EXPAND; ++i) {\n    code.push(\"case \", i, \":return o\", i, \"(\", args.slice(0, i).join(), \");\");\n  }\n\n  code.push(\"}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation\");\n  procArgs.push(code.join(\"\"));\n  var proc = Function.apply(undefined, procArgs);\n  module.exports = proc.apply(undefined, [slowOrient].concat(CACHED));\n\n  for (var i = 0; i <= NUM_EXPAND; ++i) {\n    module.exports[i] = CACHED[i];\n  }\n}\n\ngenerateOrientationProc();","map":{"version":3,"sources":["/Users/caseyrudick/Documents/landsharkrefactored-copy/client/node_modules/robust-orientation/orientation.js"],"names":["twoProduct","require","robustSum","robustScale","robustSubtract","NUM_EXPAND","EPSILON","ERRBOUND3","ERRBOUND4","cofactor","m","c","result","Array","length","i","r","j","k","matrix","n","join","sign","generateSum","expr","slice","determinant","push","orientation","pos","neg","args","apply","posExpr","negExpr","funcName","code","proc","Function","orientation3Exact","orientation4Exact","CACHED","orientation0","orientation1","orientation2","a","b","orientation3","l","det","s","tol","orientation4","d","adx","bdx","cdx","ady","bdy","cdy","adz","bdz","cdz","bdxcdy","cdxbdy","cdxady","adxcdy","adxbdy","bdxady","permanent","Math","abs","slowOrient","undefined","generateOrientationProc","procArgs","module","exports","concat"],"mappings":"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","sourcesContent":["\"use strict\"\n\nvar twoProduct = require(\"two-product\")\nvar robustSum = require(\"robust-sum\")\nvar robustScale = require(\"robust-scale\")\nvar robustSubtract = require(\"robust-subtract\")\n\nvar NUM_EXPAND = 5\n\nvar EPSILON     = 1.1102230246251565e-16\nvar ERRBOUND3   = (3.0 + 16.0 * EPSILON) * EPSILON\nvar ERRBOUND4   = (7.0 + 56.0 * EPSILON) * EPSILON\n\nfunction cofactor(m, c) {\n  var result = new Array(m.length-1)\n  for(var i=1; i<m.length; ++i) {\n    var r = result[i-1] = new Array(m.length-1)\n    for(var j=0,k=0; j<m.length; ++j) {\n      if(j === c) {\n        continue\n      }\n      r[k++] = m[i][j]\n    }\n  }\n  return result\n}\n\nfunction matrix(n) {\n  var result = new Array(n)\n  for(var i=0; i<n; ++i) {\n    result[i] = new Array(n)\n    for(var j=0; j<n; ++j) {\n      result[i][j] = [\"m\", j, \"[\", (n-i-1), \"]\"].join(\"\")\n    }\n  }\n  return result\n}\n\nfunction sign(n) {\n  if(n & 1) {\n    return \"-\"\n  }\n  return \"\"\n}\n\nfunction generateSum(expr) {\n  if(expr.length === 1) {\n    return expr[0]\n  } else if(expr.length === 2) {\n    return [\"sum(\", expr[0], \",\", expr[1], \")\"].join(\"\")\n  } else {\n    var m = expr.length>>1\n    return [\"sum(\", generateSum(expr.slice(0, m)), \",\", generateSum(expr.slice(m)), \")\"].join(\"\")\n  }\n}\n\nfunction determinant(m) {\n  if(m.length === 2) {\n    return [[\"sum(prod(\", m[0][0], \",\", m[1][1], \"),prod(-\", m[0][1], \",\", m[1][0], \"))\"].join(\"\")]\n  } else {\n    var expr = []\n    for(var i=0; i<m.length; ++i) {\n      expr.push([\"scale(\", generateSum(determinant(cofactor(m, i))), \",\", sign(i), m[0][i], \")\"].join(\"\"))\n    }\n    return expr\n  }\n}\n\nfunction orientation(n) {\n  var pos = []\n  var neg = []\n  var m = matrix(n)\n  var args = []\n  for(var i=0; i<n; ++i) {\n    if((i&1)===0) {\n      pos.push.apply(pos, determinant(cofactor(m, i)))\n    } else {\n      neg.push.apply(neg, determinant(cofactor(m, i)))\n    }\n    args.push(\"m\" + i)\n  }\n  var posExpr = generateSum(pos)\n  var negExpr = generateSum(neg)\n  var funcName = \"orientation\" + n + \"Exact\"\n  var code = [\"function \", funcName, \"(\", args.join(), \"){var p=\", posExpr, \",n=\", negExpr, \",d=sub(p,n);\\\nreturn d[d.length-1];};return \", funcName].join(\"\")\n  var proc = new Function(\"sum\", \"prod\", \"scale\", \"sub\", code)\n  return proc(robustSum, twoProduct, robustScale, robustSubtract)\n}\n\nvar orientation3Exact = orientation(3)\nvar orientation4Exact = orientation(4)\n\nvar CACHED = [\n  function orientation0() { return 0 },\n  function orientation1() { return 0 },\n  function orientation2(a, b) { \n    return b[0] - a[0]\n  },\n  function orientation3(a, b, c) {\n    var l = (a[1] - c[1]) * (b[0] - c[0])\n    var r = (a[0] - c[0]) * (b[1] - c[1])\n    var det = l - r\n    var s\n    if(l > 0) {\n      if(r <= 0) {\n        return det\n      } else {\n        s = l + r\n      }\n    } else if(l < 0) {\n      if(r >= 0) {\n        return det\n      } else {\n        s = -(l + r)\n      }\n    } else {\n      return det\n    }\n    var tol = ERRBOUND3 * s\n    if(det >= tol || det <= -tol) {\n      return det\n    }\n    return orientation3Exact(a, b, c)\n  },\n  function orientation4(a,b,c,d) {\n    var adx = a[0] - d[0]\n    var bdx = b[0] - d[0]\n    var cdx = c[0] - d[0]\n    var ady = a[1] - d[1]\n    var bdy = b[1] - d[1]\n    var cdy = c[1] - d[1]\n    var adz = a[2] - d[2]\n    var bdz = b[2] - d[2]\n    var cdz = c[2] - d[2]\n    var bdxcdy = bdx * cdy\n    var cdxbdy = cdx * bdy\n    var cdxady = cdx * ady\n    var adxcdy = adx * cdy\n    var adxbdy = adx * bdy\n    var bdxady = bdx * ady\n    var det = adz * (bdxcdy - cdxbdy) \n            + bdz * (cdxady - adxcdy)\n            + cdz * (adxbdy - bdxady)\n    var permanent = (Math.abs(bdxcdy) + Math.abs(cdxbdy)) * Math.abs(adz)\n                  + (Math.abs(cdxady) + Math.abs(adxcdy)) * Math.abs(bdz)\n                  + (Math.abs(adxbdy) + Math.abs(bdxady)) * Math.abs(cdz)\n    var tol = ERRBOUND4 * permanent\n    if ((det > tol) || (-det > tol)) {\n      return det\n    }\n    return orientation4Exact(a,b,c,d)\n  }\n]\n\nfunction slowOrient(args) {\n  var proc = CACHED[args.length]\n  if(!proc) {\n    proc = CACHED[args.length] = orientation(args.length)\n  }\n  return proc.apply(undefined, args)\n}\n\nfunction generateOrientationProc() {\n  while(CACHED.length <= NUM_EXPAND) {\n    CACHED.push(orientation(CACHED.length))\n  }\n  var args = []\n  var procArgs = [\"slow\"]\n  for(var i=0; i<=NUM_EXPAND; ++i) {\n    args.push(\"a\" + i)\n    procArgs.push(\"o\" + i)\n  }\n  var code = [\n    \"function getOrientation(\", args.join(), \"){switch(arguments.length){case 0:case 1:return 0;\"\n  ]\n  for(var i=2; i<=NUM_EXPAND; ++i) {\n    code.push(\"case \", i, \":return o\", i, \"(\", args.slice(0, i).join(), \");\")\n  }\n  code.push(\"}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation\")\n  procArgs.push(code.join(\"\"))\n\n  var proc = Function.apply(undefined, procArgs)\n  module.exports = proc.apply(undefined, [slowOrient].concat(CACHED))\n  for(var i=0; i<=NUM_EXPAND; ++i) {\n    module.exports[i] = CACHED[i]\n  }\n}\n\ngenerateOrientationProc()"]},"metadata":{},"sourceType":"script"}